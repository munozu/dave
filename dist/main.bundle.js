(function(){/*
 Source code licensed under Apache License 2.0. Copyright Â© 2017-current William Ngan and contributors. (https://github.com/williamngan/pts) */
'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(l){return l.raw=l};$jscomp.createTemplateTagFirstArgWithRaw=function(l,g){l.raw=g;return l};$jscomp.arrayIteratorImpl=function(l){var g=0;return function(){return g<l.length?{done:!1,value:l[g++]}:{done:!0}}};$jscomp.arrayIterator=function(l){return{next:$jscomp.arrayIteratorImpl(l)}};
$jscomp.makeIterator=function(l){var g="undefined"!=typeof Symbol&&Symbol.iterator&&l[Symbol.iterator];return g?g.call(l):$jscomp.arrayIterator(l)};$jscomp.arrayFromIterator=function(l){for(var g,m=[];!(g=l.next()).done;)m.push(g.value);return m};$jscomp.arrayFromIterable=function(l){return l instanceof Array?l:$jscomp.arrayFromIterator($jscomp.makeIterator(l))};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(l){var g=function(){};g.prototype=l;return new g};$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(l,g,m){if(l==Array.prototype||l==Object.prototype)return l;l[g]=m.value;return l};
$jscomp.getGlobal=function(l){l=["object"==typeof globalThis&&globalThis,l,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var g=0;g<l.length;++g){var m=l[g];if(m&&m.Math==Math)return m}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};
$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(l,g){var m=$jscomp.propertyToPolyfillSymbol[g];if(null==m)return l[g];m=l[m];return void 0!==m?m:l[g]};$jscomp.polyfill=function(l,g,m,r){g&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(l,g,m,r):$jscomp.polyfillUnisolated(l,g,m,r))};
$jscomp.polyfillUnisolated=function(l,g,m,r){m=$jscomp.global;l=l.split(".");for(r=0;r<l.length-1;r++){var x=l[r];if(!(x in m))return;m=m[x]}l=l[l.length-1];r=m[l];g=g(r);g!=r&&null!=g&&$jscomp.defineProperty(m,l,{configurable:!0,writable:!0,value:g})};
$jscomp.polyfillIsolated=function(l,g,m,r){var x=l.split(".");l=1===x.length;r=x[0];r=!l&&r in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var A=0;A<x.length-1;A++){var p=x[A];if(!(p in r))return;r=r[p]}x=x[x.length-1];m=$jscomp.IS_SYMBOL_NATIVE&&"es6"===m?r[x]:null;g=g(m);null!=g&&(l?$jscomp.defineProperty($jscomp.polyfills,x,{configurable:!0,writable:!0,value:g}):g!==m&&(void 0===$jscomp.propertyToPolyfillSymbol[x]&&(m=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[x]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(x):$jscomp.POLYFILL_PREFIX+m+"$"+x),$jscomp.defineProperty(r,$jscomp.propertyToPolyfillSymbol[x],{configurable:!0,writable:!0,value:g})))};
$jscomp.getConstructImplementation=function(){function l(){function m(){}new m;Reflect.construct(m,[],function(){});return new m instanceof m}if($jscomp.TRUST_ES6_POLYFILLS&&"undefined"!=typeof Reflect&&Reflect.construct){if(l())return Reflect.construct;var g=Reflect.construct;return function(m,r,x){m=g(m,r);x&&Reflect.setPrototypeOf(m,x.prototype);return m}}return function(m,r,x){void 0===x&&(x=m);x=$jscomp.objectCreate(x.prototype||Object.prototype);return Function.prototype.apply.call(m,x,r)||
x}};$jscomp.construct={valueOf:$jscomp.getConstructImplementation}.valueOf();$jscomp.underscoreProtoCanBeSet=function(){var l={a:!0},g={};try{return g.__proto__=l,g.a}catch(m){}return!1};$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(l,g){l.__proto__=g;if(l.__proto__!==g)throw new TypeError(l+" is not extensible");return l}:null;
$jscomp.inherits=function(l,g){l.prototype=$jscomp.objectCreate(g.prototype);l.prototype.constructor=l;if($jscomp.setPrototypeOf){var m=$jscomp.setPrototypeOf;m(l,g)}else for(m in g)if("prototype"!=m)if(Object.defineProperties){var r=Object.getOwnPropertyDescriptor(g,m);r&&Object.defineProperty(l,m,r)}else l[m]=g[m];l.superClass_=g.prototype};$jscomp.generator={};
$jscomp.generator.ensureIteratorResultIsObject_=function(l){if(!(l instanceof Object))throw new TypeError("Iterator result "+l+" is not an object");};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};
$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(l){this.yieldResult=l};
$jscomp.generator.Context.prototype.throw_=function(l){this.abruptCompletion_={exception:l,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(l){this.abruptCompletion_={return:l};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(l){this.abruptCompletion_={jumpTo:l};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(l,g){this.nextAddress=g;return{value:l}};
$jscomp.generator.Context.prototype.yieldAll=function(l,g){l=$jscomp.makeIterator(l);var m=l.next();$jscomp.generator.ensureIteratorResultIsObject_(m);if(m.done)this.yieldResult=m.value,this.nextAddress=g;else return this.yieldAllIterator_=l,this.yield(m.value,g)};$jscomp.generator.Context.prototype.jumpTo=function(l){this.nextAddress=l};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};
$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(l,g){this.catchAddress_=l;void 0!=g&&(this.finallyAddress_=g)};$jscomp.generator.Context.prototype.setFinallyBlock=function(l){this.catchAddress_=0;this.finallyAddress_=l||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(l,g){this.nextAddress=l;this.catchAddress_=g||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(l){this.catchAddress_=l||0;l=this.abruptCompletion_.exception;this.abruptCompletion_=null;return l};$jscomp.generator.Context.prototype.enterFinallyBlock=function(l,g,m){m?this.finallyContexts_[m]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=l||0;this.finallyAddress_=g||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(l,g){g=this.finallyContexts_.splice(g||0)[0];if(g=this.abruptCompletion_=this.abruptCompletion_||g){if(g.isException)return this.jumpToErrorHandler_();void 0!=g.jumpTo&&this.finallyAddress_<g.jumpTo?(this.nextAddress=g.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=l};$jscomp.generator.Context.prototype.forIn=function(l){return new $jscomp.generator.Context.PropertyIterator(l)};
$jscomp.generator.Context.PropertyIterator=function(l){this.object_=l;this.properties_=[];for(var g in l)this.properties_.push(g);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var l=this.properties_.pop();if(l in this.object_)return l}return null};$jscomp.generator.Engine_=function(l){this.context_=new $jscomp.generator.Context;this.program_=l};
$jscomp.generator.Engine_.prototype.next_=function(l){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,l,this.context_.next_);this.context_.next_(l);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(l){this.context_.start_();var g=this.context_.yieldAllIterator_;if(g)return this.yieldAllStep_("return"in g?g["return"]:function(m){return{value:m,done:!0}},l,this.context_.return);this.context_.return(l);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(l){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],l,this.context_.next_);this.context_.throw_(l);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(l,g,m){try{var r=l.call(this.context_.yieldAllIterator_,g);$jscomp.generator.ensureIteratorResultIsObject_(r);if(!r.done)return this.context_.stop_(),r;var x=r.value}catch(A){return this.context_.yieldAllIterator_=null,this.context_.throw_(A),this.nextStep_()}this.context_.yieldAllIterator_=null;m.call(this.context_,x);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var l=this.program_(this.context_);if(l)return this.context_.stop_(),{value:l.value,done:!1}}catch(g){this.context_.yieldResult=void 0,this.context_.throw_(g)}this.context_.stop_();if(this.context_.abruptCompletion_){l=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(l.isException)throw l.exception;return{value:l.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(l){this.next=function(g){return l.next_(g)};this.throw=function(g){return l.throw_(g)};this.return=function(g){return l.return_(g)};this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(l,g){g=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(g));$jscomp.setPrototypeOf&&l.prototype&&$jscomp.setPrototypeOf(g,l.prototype);return g};$jscomp.polyfill("Reflect",function(l){return l?l:{}},"es6","es3");
$jscomp.polyfill("Reflect.construct",function(l){return $jscomp.construct},"es6","es3");$jscomp.polyfill("Reflect.setPrototypeOf",function(l){if(l)return l;if($jscomp.setPrototypeOf){var g=$jscomp.setPrototypeOf;return function(m,r){try{return g(m,r),!0}catch(x){return!1}}}return null},"es6","es5");$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(l){if(l)return l;var g=function(A,p){this.$jscomp$symbol$id_=A;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:p})};g.prototype.toString=function(){return this.$jscomp$symbol$id_};var m="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",r=0,x=function(A){if(this instanceof x)throw new TypeError("Symbol is not a constructor");return new g(m+(A||"")+"_"+r++,A)};return x},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(l){if(l)return l;l=Symbol("Symbol.iterator");for(var g="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),m=0;m<g.length;m++){var r=$jscomp.global[g[m]];"function"===typeof r&&"function"!=typeof r.prototype[l]&&$jscomp.defineProperty(r.prototype,l,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return l},"es6",
"es3");$jscomp.iteratorPrototype=function(l){l={next:l};l[Symbol.iterator]=function(){return this};return l};$jscomp.polyfill("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991},"es6","es3");$jscomp.polyfill("Array.prototype.fill",function(l){return l?l:function(g,m,r){var x=this.length||0;0>m&&(m=Math.max(0,x+m));if(null==r||r>x)r=x;r=Number(r);0>r&&(r=Math.max(0,x+r));for(m=Number(m||0);m<r;m++)this[m]=g;return this}},"es6","es3");$jscomp.typedArrayFill=function(l){return l?l:Array.prototype.fill};
$jscomp.polyfill("Int8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint8ClampedArray.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Uint32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Float32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Float64Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.checkEs6ConformanceViaProxy=function(){try{var l={},g=Object.create(new $jscomp.global.Proxy(l,{get:function(m,r,x){return m==l&&"q"==r&&x==g}}));return!0===g.q}catch(m){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.owns=function(l,g){return Object.prototype.hasOwnProperty.call(l,g)};
$jscomp.polyfill("WeakMap",function(l){function g(){if(!l||!Object.seal)return!1;try{var q=Object.seal({}),v=Object.seal({}),D=new l([[q,2],[v,3]]);if(2!=D.get(q)||3!=D.get(v))return!1;D.delete(q);D.set(v,4);return!D.has(q)&&4==D.get(v)}catch(z){return!1}}function m(){}function r(q){var v=typeof q;return"object"===v&&null!==q||"function"===v}function x(q){if(!$jscomp.owns(q,p)){var v=new m;$jscomp.defineProperty(q,p,{value:v})}}function A(q){if(!$jscomp.ISOLATE_POLYFILLS){var v=Object[q];v&&(Object[q]=
function(D){if(D instanceof m)return D;Object.isExtensible(D)&&x(D);return v(D)})}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(l&&$jscomp.ES6_CONFORMANCE)return l}else if(g())return l;var p="$jscomp_hidden_"+Math.random();A("freeze");A("preventExtensions");A("seal");var B=0,t=function(q){this.id_=(B+=Math.random()+1).toString();if(q){q=$jscomp.makeIterator(q);for(var v;!(v=q.next()).done;)v=v.value,this.set(v[0],v[1])}};t.prototype.set=function(q,v){if(!r(q))throw Error("Invalid WeakMap key");
x(q);if(!$jscomp.owns(q,p))throw Error("WeakMap key fail: "+q);q[p][this.id_]=v;return this};t.prototype.get=function(q){return r(q)&&$jscomp.owns(q,p)?q[p][this.id_]:void 0};t.prototype.has=function(q){return r(q)&&$jscomp.owns(q,p)&&$jscomp.owns(q[p],this.id_)};t.prototype.delete=function(q){return r(q)&&$jscomp.owns(q,p)&&$jscomp.owns(q[p],this.id_)?delete q[p][this.id_]:!1};return t},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(l){function g(){if($jscomp.ASSUME_NO_NATIVE_MAP||!l||"function"!=typeof l||!l.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),q=new l($jscomp.makeIterator([[t,"s"]]));if("s"!=q.get(t)||1!=q.size||q.get({x:4})||q.set({x:4},"t")!=q||2!=q.size)return!1;var v=q.entries(),D=v.next();if(D.done||D.value[0]!=t||"s"!=D.value[1])return!1;D=v.next();return D.done||4!=D.value[0].x||"t"!=D.value[1]||!v.next().done?!1:!0}catch(z){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(l&&$jscomp.ES6_CONFORMANCE)return l}else if(g())return l;var m=new WeakMap,r=function(t){this.data_={};this.head_=p();this.size=0;if(t){t=$jscomp.makeIterator(t);for(var q;!(q=t.next()).done;)q=q.value,this.set(q[0],q[1])}};r.prototype.set=function(t,q){t=0===t?0:t;var v=x(this,t);v.list||(v.list=this.data_[v.id]=[]);v.entry?v.entry.value=q:(v.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:t,value:q},v.list.push(v.entry),
this.head_.previous.next=v.entry,this.head_.previous=v.entry,this.size++);return this};r.prototype.delete=function(t){t=x(this,t);return t.entry&&t.list?(t.list.splice(t.index,1),t.list.length||delete this.data_[t.id],t.entry.previous.next=t.entry.next,t.entry.next.previous=t.entry.previous,t.entry.head=null,this.size--,!0):!1};r.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=p();this.size=0};r.prototype.has=function(t){return!!x(this,t).entry};r.prototype.get=function(t){return(t=
x(this,t).entry)&&t.value};r.prototype.entries=function(){return A(this,function(t){return[t.key,t.value]})};r.prototype.keys=function(){return A(this,function(t){return t.key})};r.prototype.values=function(){return A(this,function(t){return t.value})};r.prototype.forEach=function(t,q){for(var v=this.entries(),D;!(D=v.next()).done;)D=D.value,t.call(q,D[1],D[0],this)};r.prototype[Symbol.iterator]=r.prototype.entries;var x=function(t,q){var v=q&&typeof q;"object"==v||"function"==v?m.has(q)?v=m.get(q):
(v=""+ ++B,m.set(q,v)):v="p_"+q;var D=t.data_[v];if(D&&$jscomp.owns(t.data_,v))for(t=0;t<D.length;t++){var z=D[t];if(q!==q&&z.key!==z.key||q===z.key)return{id:v,list:D,index:t,entry:z}}return{id:v,list:D,index:-1,entry:void 0}},A=function(t,q){var v=t.head_;return $jscomp.iteratorPrototype(function(){if(v){for(;v.head!=t.head_;)v=v.previous;for(;v.next!=v.head;)return v=v.next,{done:!1,value:q(v)};v=null}return{done:!0,value:void 0}})},p=function(){var t={};return t.previous=t.next=t.head=t},B=0;
return r},"es6","es3");$jscomp.polyfill("Array.from",function(l){return l?l:function(g,m,r){m=null!=m?m:function(B){return B};var x=[],A="undefined"!=typeof Symbol&&Symbol.iterator&&g[Symbol.iterator];if("function"==typeof A){g=A.call(g);for(var p=0;!(A=g.next()).done;)x.push(m.call(r,A.value,p++))}else for(A=g.length,p=0;p<A;p++)x.push(m.call(r,g[p],p));return x}},"es6","es3");
$jscomp.iteratorFromArray=function(l,g){l instanceof String&&(l+="");var m=0,r=!1,x={next:function(){if(!r&&m<l.length){var A=m++;return{value:g(A,l[A]),done:!1}}r=!0;return{done:!0,value:void 0}}};x[Symbol.iterator]=function(){return x};return x};$jscomp.polyfill("Array.prototype.values",function(l){return l?l:function(){return $jscomp.iteratorFromArray(this,function(g,m){return m})}},"es8","es3");
$jscomp.polyfill("Array.prototype.keys",function(l){return l?l:function(){return $jscomp.iteratorFromArray(this,function(g){return g})}},"es6","es3");
$jscomp.polyfill("Promise",function(l){function g(){this.batch_=null}function m(p){return p instanceof x?p:new x(function(B,t){B(p)})}if(l&&(!($jscomp.FORCE_POLYFILL_PROMISE||$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION&&"undefined"===typeof $jscomp.global.PromiseRejectionEvent)||!$jscomp.global.Promise||-1===$jscomp.global.Promise.toString().indexOf("[native code]")))return l;g.prototype.asyncExecute=function(p){if(null==this.batch_){this.batch_=[];var B=this;this.asyncExecuteFunction(function(){B.executeBatch_()})}this.batch_.push(p)};
var r=$jscomp.global.setTimeout;g.prototype.asyncExecuteFunction=function(p){r(p,0)};g.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var p=this.batch_;this.batch_=[];for(var B=0;B<p.length;++B){var t=p[B];p[B]=null;try{t()}catch(q){this.asyncThrow_(q)}}}this.batch_=null};g.prototype.asyncThrow_=function(p){this.asyncExecuteFunction(function(){throw p;})};var x=function(p){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];this.isRejectionHandled_=!1;var B=this.createResolveAndReject_();
try{p(B.resolve,B.reject)}catch(t){B.reject(t)}};x.prototype.createResolveAndReject_=function(){function p(q){return function(v){t||(t=!0,q.call(B,v))}}var B=this,t=!1;return{resolve:p(this.resolveTo_),reject:p(this.reject_)}};x.prototype.resolveTo_=function(p){if(p===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(p instanceof x)this.settleSameAsPromise_(p);else{a:switch(typeof p){case "object":var B=null!=p;break a;case "function":B=!0;break a;default:B=!1}B?this.resolveToNonPromiseObj_(p):
this.fulfill_(p)}};x.prototype.resolveToNonPromiseObj_=function(p){var B=void 0;try{B=p.then}catch(t){this.reject_(t);return}"function"==typeof B?this.settleSameAsThenable_(B,p):this.fulfill_(p)};x.prototype.reject_=function(p){this.settle_(2,p)};x.prototype.fulfill_=function(p){this.settle_(1,p)};x.prototype.settle_=function(p,B){if(0!=this.state_)throw Error("Cannot settle("+p+", "+B+"): Promise already settled in state"+this.state_);this.state_=p;this.result_=B;2===this.state_&&this.scheduleUnhandledRejectionCheck_();
this.executeOnSettledCallbacks_()};x.prototype.scheduleUnhandledRejectionCheck_=function(){var p=this;r(function(){if(p.notifyUnhandledRejection_()){var B=$jscomp.global.console;"undefined"!==typeof B&&B.error(p.result_)}},1)};x.prototype.notifyUnhandledRejection_=function(){if(this.isRejectionHandled_)return!1;var p=$jscomp.global.CustomEvent,B=$jscomp.global.Event,t=$jscomp.global.dispatchEvent;if("undefined"===typeof t)return!0;"function"===typeof p?p=new p("unhandledrejection",{cancelable:!0}):
"function"===typeof B?p=new B("unhandledrejection",{cancelable:!0}):(p=$jscomp.global.document.createEvent("CustomEvent"),p.initCustomEvent("unhandledrejection",!1,!0,p));p.promise=this;p.reason=this.result_;return t(p)};x.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var p=0;p<this.onSettledCallbacks_.length;++p)A.asyncExecute(this.onSettledCallbacks_[p]);this.onSettledCallbacks_=null}};var A=new g;x.prototype.settleSameAsPromise_=function(p){var B=this.createResolveAndReject_();
p.callWhenSettled_(B.resolve,B.reject)};x.prototype.settleSameAsThenable_=function(p,B){var t=this.createResolveAndReject_();try{p.call(B,t.resolve,t.reject)}catch(q){t.reject(q)}};x.prototype.then=function(p,B){function t(z,H){return"function"==typeof z?function(k){try{q(z(k))}catch(n){v(n)}}:H}var q,v,D=new x(function(z,H){q=z;v=H});this.callWhenSettled_(t(p,q),t(B,v));return D};x.prototype.catch=function(p){return this.then(void 0,p)};x.prototype.callWhenSettled_=function(p,B){function t(){switch(q.state_){case 1:p(q.result_);
break;case 2:B(q.result_);break;default:throw Error("Unexpected state: "+q.state_);}}var q=this;null==this.onSettledCallbacks_?A.asyncExecute(t):this.onSettledCallbacks_.push(t);this.isRejectionHandled_=!0};x.resolve=m;x.reject=function(p){return new x(function(B,t){t(p)})};x.race=function(p){return new x(function(B,t){for(var q=$jscomp.makeIterator(p),v=q.next();!v.done;v=q.next())m(v.value).callWhenSettled_(B,t)})};x.all=function(p){var B=$jscomp.makeIterator(p),t=B.next();return t.done?m([]):new x(function(q,
v){function D(k){return function(n){z[k]=n;H--;0==H&&q(z)}}var z=[],H=0;do z.push(void 0),H++,m(t.value).callWhenSettled_(D(z.length-1),v),t=B.next();while(!t.done)})};return x},"es6","es3");$jscomp.assign=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.assign?Object.assign:function(l,g){for(var m=1;m<arguments.length;m++){var r=arguments[m];if(r)for(var x in r)$jscomp.owns(r,x)&&(l[x]=r[x])}return l};$jscomp.polyfill("Object.assign",function(l){return l||$jscomp.assign},"es6","es3");
(function(){var l=Math.PI,g=function(){};g.warnLevel=function(a){a&&(g._warnLevel=a);return g._warnLevel};g.getArgs=function(a){if(1>a.length)return[];var b=[],c=Array.isArray(a[0])||ArrayBuffer.isView(a[0]);if("number"===typeof a[0])b=Array.prototype.slice.call(a);else if("object"!==typeof a[0]||c)c&&(b=[].slice.call(a[0]));else{c=["x","y","z","w"];a=a[0];for(var d=0;d<c.length&&!(a.length&&d>=a.length)&&c[d]in a;d++)b.push(a[c[d]])}return b};g.warn=function(a,b){a=void 0===a?"error":a;if("error"==
g.warnLevel())throw Error(a);"warn"==g.warnLevel()&&console.warn(a);return b};g.randomInt=function(a,b){b=void 0===b?0:b;g.warn("Util.randomInt is deprecated. Please use `Num.randomRange`");return Math.floor(Math.random()*a)+b};g.split=function(a,b,c,d,e){d=void 0===d?!1:d;e=void 0===e?!0:e;var f=[],h=c||b,u=0;if(0>=a.length||0>=h)return[];for(;u<a.length;){c=[];for(var y=0;y<b;y++)if(d)c.push(a[(u+y)%a.length]);else{if(u+y>=a.length)break;c.push(a[u+y])}u+=h;(!e||e&&c.length===b)&&f.push(c)}return f};
g.flatten=function(a,b){b=void 0===b||b?new n:[];return b.concat.apply(b,a)};g.combine=function(a,b,c){for(var d=[],e=0,f=a.length;e<f;e++)for(var h=0,u=b.length;h<u;h++)d.push(c(a[e],b[h]));return d};g.zip=function(a){for(var b=[],c=0,d=a[0].length;c<d;c++){for(var e=[],f=0;f<a.length;f++)e.push(a[f][c]);b.push(e)}return b};g.stepper=function(a,b,c,d){b=void 0===b?0:b;c=void 0===c?1:c;var e=b;return function(){e+=c;e>=a&&(e=b+(e-a));d&&d(e);return e}};g.forRange=function(a,b,c,d){d=void 0===d?1:
d;var e=[];for(c=void 0===c?0:c;c<b;c+=d)e[c]=a(c);return e};g.load=function(a,b){var c=new XMLHttpRequest;c.open("GET",a,!0);c.onload=function(){200<=c.status&&400>c.status?b(c.responseText,!0):b("Server error ("+c.status+') when loading "'+a+'"',!1)};c.onerror=function(){b("Unknown network error",!1)};c.send()};g.performance=function(a){a=void 0===a?10:a;var b=Date.now(),c=[];return function(){var d=Date.now();c.push(d-b);c.length>=a&&c.shift();b=d;return Math.floor(c.reduce(function(e,f){return e+
f},0)/c.length)}};g.arrayCheck=function(a,b){b=void 0===b?2:b;return Array.isArray(a)&&a.length<b?(g.warn("Requires "+b+" or more Pts in this Group."),!1):!0};g.iterToArray=function(a){return Array.isArray(a)?a:[].concat($jscomp.arrayFromIterable(a))};g.isMobile=function(){return/iPhone|iPad|Android/i.test(navigator.userAgent)};g._warnLevel="mute";var m=function(){};m.add=function(a,b){if("number"==typeof b)for(var c=0,d=a.length;c<d;c++)a[c]+=b;else for(c=0,d=a.length;c<d;c++)a[c]+=b[c]||0;return a};
m.subtract=function(a,b){if("number"==typeof b)for(var c=0,d=a.length;c<d;c++)a[c]-=b;else for(c=0,d=a.length;c<d;c++)a[c]-=b[c]||0;return a};m.multiply=function(a,b){if("number"==typeof b)for(var c=0,d=a.length;c<d;c++)a[c]*=b;else{if(a.length!=b.length)throw Error("Cannot do element-wise multiply since the array lengths don't match: "+a.toString()+" multiply-with "+b.toString());c=0;for(d=a.length;c<d;c++)a[c]*=b[c]}return a};m.divide=function(a,b){if("number"==typeof b){if(0===b)throw Error("Cannot divide by zero");
for(var c=0,d=a.length;c<d;c++)a[c]/=b}else{if(a.length!=b.length)throw Error("Cannot do element-wise divide since the array lengths don't match. "+a.toString()+" divide-by "+b.toString());c=0;for(d=a.length;c<d;c++)a[c]/=b[c]}return a};m.dot=function(a,b){if(a.length!=b.length)throw Error("Array lengths don't match");for(var c=0,d=0,e=a.length;d<e;d++)c+=a[d]*b[d];return c};m.cross2D=function(a,b){return a[0]*b[1]-a[1]*b[0]};m.cross=function(a,b){return new k(a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],
a[0]*b[1]-a[1]*b[0])};m.magnitude=function(a){return Math.sqrt(m.dot(a,a))};m.unit=function(a,b){b=void 0===b?m.magnitude(a):b;return 0===b?k.make(a.length):m.divide(a,b)};m.abs=function(a){return m.map(a,Math.abs)};m.floor=function(a){return m.map(a,Math.floor)};m.ceil=function(a){return m.map(a,Math.ceil)};m.round=function(a){return m.map(a,Math.round)};m.max=function(a){for(var b=Number.MIN_VALUE,c=0,d=0,e=a.length;d<e;d++)b=Math.max(b,a[d]),b===a[d]&&(c=d);return{value:b,index:c}};m.min=function(a){for(var b=
Number.MAX_VALUE,c=0,d=0,e=a.length;d<e;d++)b=Math.min(b,a[d]),b===a[d]&&(c=d);return{value:b,index:c}};m.sum=function(a){for(var b=0,c=0,d=a.length;c<d;c++)b+=a[c];return b};m.map=function(a,b){for(var c=0,d=a.length;c<d;c++)a[c]=b(a[c],c,a);return a};var r=function(){};r.add=function(a,b){if("number"!=typeof b){if(a[0].length!=b[0].length)throw Error("Cannot add matrix if rows' and columns' size don't match.");if(a.length!=b.length)throw Error("Cannot add matrix if rows' and columns' size don't match.");
}for(var c=new n,d="number"==typeof b,e=0,f=a.length;e<f;e++)c.push(a[e].$add(d?b:b[e]));return c};r.multiply=function(a,b,c,d){c=void 0===c?!1:c;d=void 0===d?!1:d;var e=new n;if("number"!=typeof b)if(d){if(a.length!=b.length)throw Error("Cannot multiply matrix element-wise because the matrices' sizes don't match.");c=0;for(d=a.length;c<d;c++)e.push(a[c].$multiply(b[c]))}else{if(!c&&a[0].length!=b.length)throw Error("Cannot multiply matrix if rows in matrix-a don't match columns in matrix-b.");if(c&&
a[0].length!=b[0].length)throw Error("Cannot multiply matrix if transposed and the columns in both matrices don't match.");c||(b=r.transpose(b));c=0;for(d=a.length;c<d;c++){for(var f=k.make(b.length,0),h=0,u=b.length;h<u;h++)f[h]=m.dot(a[c],b[h]);e.push(f)}}else for(c=0,d=a.length;c<d;c++)e.push(a[c].$multiply(b));return e};r.zipSlice=function(a,b,c){c=void 0===c?!1:c;for(var d=[],e=0,f=a.length;e<f;e++){if(a[e].length-1<b&&!1===c)throw"Index "+b+" is out of bounds";d.push(a[e][b]||c)}return new k(d)};
r.zip=function(a,b,c){b=void 0===b?!1:b;c=void 0===c?!1:c;var d=new n;c=c?a.reduce(function(f,h){return Math.max(f,h.length)},0):a[0].length;for(var e=0;e<c;e++)d.push(r.zipSlice(a,e,b));return d};r.transpose=function(a,b,c){return r.zip(a,void 0===b?!1:b,void 0===c?!1:c)};r.transform2D=function(a,b){return new k(a[0]*b[0][0]+a[1]*b[1][0]+b[2][0],a[0]*b[0][1]+a[1]*b[1][1]+b[2][1])};r.scale2DMatrix=function(a,b){return new n(new k(a,0,0),new k(0,b,0),new k(0,0,1))};r.rotate2DMatrix=function(a,b){return new n(new k(a,
b,0),new k(-b,a,0),new k(0,0,1))};r.shear2DMatrix=function(a,b){return new n(new k(1,a,0),new k(b,1,0),new k(0,0,1))};r.translate2DMatrix=function(a,b){return new n(new k(1,0,0),new k(0,1,0),new k(a,b,1))};r.scaleAt2DMatrix=function(a,b,c){var d=r.scale2DMatrix(a,b);d[2][0]=-c[0]*a+c[0];d[2][1]=-c[1]*b+c[1];return d};r.rotateAt2DMatrix=function(a,b,c){var d=r.rotate2DMatrix(a,b);d[2][0]=c[0]*(1-a)+c[1]*b;d[2][1]=c[1]*(1-a)-c[0]*b;return d};r.shearAt2DMatrix=function(a,b,c){var d=r.shear2DMatrix(a,
b);d[2][0]=-c[1]*b;d[2][1]=-c[0]*a;return d};r.reflectAt2DMatrix=function(a,b){var c=A.intercept(a,b);if(void 0==c)return[new k([-1,0,0]),new k([0,1,0]),new k([a[0]+b[0],0,1])];a=c.yi;b=2*Math.atan(c.slope);c=Math.cos(b);b=Math.sin(b);return[new k([c,b,0]),new k([b,-c,0]),new k([-a*b,a+a*c,1])]};var x=function(a,b){return g.warn("Group's length is less than "+(void 0===b?"expected":b),a)},A=function(){};A.fromAngle=function(a,b,c){a=new n(new k(a),new k(a));a[1].toAngle(b,c,!0);return a};A.slope=
function(a,b){return 0===b[0]-a[0]?void 0:(b[1]-a[1])/(b[0]-a[0])};A.intercept=function(a,b){if(0!==b[0]-a[0])return b=(b[1]-a[1])/(b[0]-a[0]),a=a[1]-b*a[0],{slope:b,yi:a,xi:0===b?void 0:-a/b}};A.sideOfPt2D=function(a,b){a=g.iterToArray(a);return(a[1][0]-a[0][0])*(b[1]-a[0][1])-(b[0]-a[0][0])*(a[1][1]-a[0][1])};A.collinear=function(a,b,c,d){d=void 0===d?.01:d;b=(new k(0,0,0)).to(a).$subtract(b);a=(new k(0,0,0)).to(a).$subtract(c);return b.$cross(a).divide(1E3).equals(new k(0,0,0),d)};A.magnitude=
function(a){a=g.iterToArray(a);return 2<=a.length?a[1].$subtract(a[0]).magnitude():0};A.magnitudeSq=function(a){a=g.iterToArray(a);return 2<=a.length?a[1].$subtract(a[0]).magnitudeSq():0};A.perpendicularFromPt=function(a,b,c){c=void 0===c?!1:c;var d=g.iterToArray(a);if(!d[0].equals(d[1]))return a=d[0].$subtract(d[1]),d=d[1].$subtract(b),a=d.$subtract(a.$project(d)),c?a:a.$add(b)};A.distanceFromPt=function(a,b){a=g.iterToArray(a);var c=A.perpendicularFromPt(a,b,!0);return c?c.magnitude():a[0].$subtract(b).magnitude()};
A.intersectRay2D=function(a,b){var c=g.iterToArray(a),d=g.iterToArray(b);b=A.intercept(c[0],c[1]);a=A.intercept(d[0],d[1]);c=c[0];d=d[0];if(void 0==b)return void 0==a?void 0:new k(c[0],-a.slope*(d[0]-c[0])+d[1]);if(void 0==a)return new k(d[0],-b.slope*(c[0]-d[0])+c[1]);if(a.slope!=b.slope)return a=(b.slope*c[0]-a.slope*d[0]+d[1]-c[1])/(b.slope-a.slope),new k(a,b.slope*(a-c[0])+c[1]);if(b.yi==a.yi)return new k(c[0],c[1])};A.intersectLine2D=function(a,b){a=g.iterToArray(a);b=g.iterToArray(b);var c=
A.intersectRay2D(a,b);return c&&z.withinBound(c,a[0],a[1])&&z.withinBound(c,b[0],b[1])?c:void 0};A.intersectLineWithRay2D=function(a,b){a=g.iterToArray(a);b=g.iterToArray(b);return(b=A.intersectRay2D(a,b))&&z.withinBound(b,a[0],a[1])?b:void 0};A.intersectPolygon2D=function(a,b,c){c=void 0===c?!1:c;a=g.iterToArray(a);b=g.iterToArray(b);c=c?A.intersectLineWithRay2D:A.intersectLine2D;for(var d=new n,e=0,f=b.length;e<f;e++){var h=c([b[e],b[e===f-1?0:e+1]],a);h&&d.push(h)}return 0<d.length?d:void 0};A.intersectLines2D=
function(a,b,c){c=void 0===c?!1:c;var d=new n;c=c?A.intersectLineWithRay2D:A.intersectLine2D;a=$jscomp.makeIterator(a);for(var e=a.next();!e.done;e=a.next()){e=e.value;for(var f=$jscomp.makeIterator(b),h=f.next();!h.done;h=f.next())(h=c(e,h.value))&&d.push(h)}return d};A.intersectGridWithRay2D=function(a,b){a=g.iterToArray(a);a=A.intercept((new k(a[0])).subtract(b),(new k(a[1])).subtract(b));var c=new n;a&&a.xi&&c.push(new k(b[0]+a.xi,b[1]));a&&a.yi&&c.push(new k(b[0],b[1]+a.yi));return c};A.intersectGridWithLine2D=
function(a,b){a=g.iterToArray(a);b=A.intersectGridWithRay2D(a,b);for(var c=new n,d=0,e=b.length;d<e;d++)z.withinBound(b[d],a[0],a[1])&&c.push(b[d]);return c};A.intersectRect2D=function(a,b){a=g.iterToArray(a);b=g.iterToArray(b);var c=z.boundingBox(n.fromPtArray(a));return p.hasIntersectRect2D(c,b)?A.intersectLines2D([a],p.sides(b)):new n};A.subpoints=function(a,b){a=g.iterToArray(a);for(var c=new n,d=1;d<=b;d++)c.push(z.interpolate(a[0],a[1],d/(b+1)));return c};A.crop=function(a,b,c,d){c=void 0===
c?0:c;d=void 0===d?!0:d;a=g.iterToArray(a);var e=a[0===c?1:0].$subtract(a[c]);if(0===e[0]||0===b[0])return a[c];if(d)return b=e.unit().multiply(b[1]),a[c].$add(b);c=p.fromCenter(a[c],b);c=p.sides(c);return A.intersectRay2D(c[Math.abs(e[1]/e[0])>Math.abs(b[1]/b[0])?0>e[1]?0:2:0>e[0]?3:1],a)};A.marker=function(a,b,c,d){c=void 0===c?"arrow":c;d=void 0===d?!0:d;a=g.iterToArray(a);var e=d?1:0;d=a[d?0:1].$subtract(a[e]);if(0===d.magnitudeSq())return new n;d.unit();var f=z.perpendicular(d).multiply(b[0]).add(a[e]);
return"arrow"==c?(f.add(d.$multiply(b[1])),new n(a[e],f[0],f[1])):new n(f[0],f[1])};A.toRect=function(a){a=g.iterToArray(a);return new n(a[0].$min(a[1]),a[0].$max(a[1]))};var p=function(){};p.from=function(a,b,c){return p.fromTopLeft(a,b,c)};p.fromTopLeft=function(a,b,c){b="number"==typeof b?[b,c||b]:b;return new n(new k(a),(new k(a)).add(b))};p.fromCenter=function(a,b,c){b="number"==typeof b?[b/2,(c||b)/2]:(new k(b)).divide(2);return new n((new k(a)).subtract(b),(new k(a)).add(b))};p.toCircle=function(a,
b){return B.fromRect(a,void 0===b?!0:b)};p.toSquare=function(a,b){b=void 0===b?!1:b;a=g.iterToArray(a);var c=p.size(a);b=b?c.maxValue().value:c.minValue().value;return p.fromCenter(p.center(a),b,b)};p.size=function(a){a=g.iterToArray(a);return a[0].$max(a[1]).subtract(a[0].$min(a[1]))};p.center=function(a){var b=g.iterToArray(a);a=b[0].$min(b[1]);b=b[0].$max(b[1]);return a.add(b.$subtract(a).divide(2))};p.corners=function(a){var b=g.iterToArray(a);a=b[0].$min(b[1]);b=b[0].$max(b[1]);return new n(a,
new k(b.x,a.y),b,new k(a.x,b.y))};p.sides=function(a){var b=$jscomp.makeIterator(p.corners(a));a=b.next().value;var c=b.next().value,d=b.next().value;b=b.next().value;return[new n(a,c),new n(c,d),new n(d,b),new n(b,a)]};p.boundingBox=function(a){a=g.iterToArray(a);a=g.flatten(a,!1);for(var b=k.make(2,Number.MAX_VALUE),c=k.make(2,Number.MIN_VALUE),d=0,e=a.length;d<e;d++)for(var f=0,h=$jscomp.makeIterator(a[d]),u=h.next();!u.done&&!(u=u.value,b[f]=Math.min(b[f],u[f]),c[f]=Math.max(c[f],u[f]),2<=++f);u=
h.next());return new n(b,c)};p.polygon=function(a){return p.corners(a)};p.quadrants=function(a,b){a=g.iterToArray(a);var c=p.corners(a),d=void 0!=b?new k(b):p.center(a);return c.map(function(e){return(new n(e,d)).boundingBox()})};p.halves=function(a,b,c){b=void 0===b?.5:b;c=void 0===c?!1:c;var d=g.iterToArray(a);a=d[0].$min(d[1]);d=d[0].$max(d[1]);b=c?D.lerp(a[1],d[1],b):D.lerp(a[0],d[0],b);return c?[new n(a,new k(d[0],b)),new n(new k(a[0],b),d)]:[new n(a,new k(b,d[1])),new n(new k(b,a[1]),d)]};p.withinBound=
function(a,b){a=g.iterToArray(a);return z.withinBound(b,a[0],a[1])};p.hasIntersectRect2D=function(a,b,c){c=void 0===c?!1:c;a=g.iterToArray(a);b=g.iterToArray(b);c&&(a=z.boundingBox(a),b=z.boundingBox(b));return a[0][0]>b[1][0]||b[0][0]>a[1][0]||a[0][1]>b[1][1]||b[0][1]>a[1][1]?!1:!0};p.intersectRect2D=function(a,b){a=g.iterToArray(a);b=g.iterToArray(b);return p.hasIntersectRect2D(a,b)?A.intersectLines2D(p.sides(a),p.sides(b)):new n};var B=function(){};B.fromRect=function(a,b){b=void 0===b?!1:b;a=
g.iterToArray(a);var c=p.size(a).minValue().value/2;b?(b=p.size(a).maxValue().value/2,b=Math.sqrt(c*c+b*b)):b=c;return new n(p.center(a),new k(b,b))};B.fromTriangle=function(a,b){return(void 0===b?0:b)?t.circumcircle(a):t.incircle(a)};B.fromCenter=function(a,b){return new n(new k(a),new k(b,b))};B.withinBound=function(a,b,c){c=void 0===c?0:c;a=g.iterToArray(a);b=a[0].$subtract(b);return b.dot(b)+c<a[1].x*a[1].x};B.intersectRay2D=function(a,b){var c=g.iterToArray(a);b=g.iterToArray(b);a=b[0].$subtract(b[1]);
var d=c[0].$subtract(b[0]),e=a.dot(a),f=d.dot(a);d=d.dot(d)-c[1].x*c[1].x;c=f/e;f=c*c-d/e;if(0>f)return new n;d=Math.sqrt(f);e=b[0].$subtract(a.$multiply(-c+d));if(0===f)return new n(e);b=b[0].$subtract(a.$multiply(-c-d));return new n(e,b)};B.intersectLine2D=function(a,b){a=g.iterToArray(a);b=g.iterToArray(b);a=B.intersectRay2D(a,b);var c=new n;if(0<a.length)for(var d=0,e=a.length;d<e;d++)p.withinBound(b,a[d])&&c.push(a[d]);return c};B.intersectCircle2D=function(a,b){a=g.iterToArray(a);var c=g.iterToArray(b);
b=c[0].$subtract(a[0]);var d=b.magnitudeSq(),e=Math.sqrt(d),f=a[1].x,h=c[1].x;c=f*f;var u=h*h;if(e>f+h)return new n;if(e<Math.abs(f-h))return new n(a[0].clone());d=(c-u+d)/(2*e);f=Math.sqrt(c-d*d);a=b.$multiply(d/e).add(a[0]);return new n(new k(a.x+f*b.y/e,a.y-f*b.x/e),new k(a.x-f*b.y/e,a.y+f*b.x/e))};B.intersectRect2D=function(a,b){a=g.iterToArray(a);b=g.iterToArray(b);b=p.sides(b);for(var c=[],d=0,e=b.length;d<e;d++){var f=B.intersectLine2D(a,b[d]);0<f.length&&c.push(f)}return g.flatten(c)};B.toRect=
function(a,b){b=void 0===b?!1:b;a=g.iterToArray(a);var c=a[1][0];return b?(b=Math.sqrt(c*c)/2,new n(a[0].$subtract(b),a[0].$add(b))):new n(a[0].$subtract(c),a[0].$add(c))};B.toTriangle=function(a,b){b=void 0===b?!0:b;a=g.iterToArray(a);if(b){b=-Math.PI/2;for(var c=2*Math.PI/3,d=new n,e=0;3>e;e++)d.push(a[0].clone().toAngle(b,a[1][0],!0)),b+=c;return d}return t.fromCenter(a[0],a[1][0])};var t=function(){};t.fromRect=function(a){a=g.iterToArray(a);var b=a[0].$add(a[1]).divide(2);b.y=a[0][1];var c=a[1].clone();
c.x=a[0][0];return new n(b,a[1].clone(),c)};t.fromCircle=function(a){return B.toTriangle(a,!0)};t.fromCenter=function(a,b){return t.fromCircle(B.fromCenter(a,b))};t.medial=function(a){a=g.iterToArray(a);return 3>a.length?x(new n,3):q.midpoints(a,!0)};t.oppositeSide=function(a,b){a=g.iterToArray(a);return 3>a.length?x(new n,3):0===b?n.fromPtArray([a[1],a[2]]):1===b?n.fromPtArray([a[0],a[2]]):n.fromPtArray([a[0],a[1]])};t.altitude=function(a,b){a=g.iterToArray(a);var c=t.oppositeSide(a,b);return 1<
c.length?new n(a[b],A.perpendicularFromPt(c,a[b])):new n};t.orthocenter=function(a){var b=g.iterToArray(a);if(3>b.length)return x(void 0,3);a=t.altitude(b,0);b=t.altitude(b,1);return A.intersectRay2D(a,b)};t.incenter=function(a){a=g.iterToArray(a);if(3>a.length)return x(void 0,3);var b=q.bisector(a,0).add(a[0]),c=q.bisector(a,1).add(a[1]);return A.intersectRay2D(new n(a[0],b),new n(a[1],c))};t.incircle=function(a,b){a=g.iterToArray(a);b=b?b:t.incenter(a);var c=q.area(a);a=q.perimeter(a,!0);return B.fromCenter(b,
2*c/a.total)};t.circumcenter=function(a){var b=g.iterToArray(a),c=t.medial(b);a=[c[0],z.perpendicular(b[0].$subtract(c[0])).p1.$add(c[0])];b=[c[1],z.perpendicular(b[1].$subtract(c[1])).p1.$add(c[1])];return A.intersectRay2D(a,b)};t.circumcircle=function(a,b){a=g.iterToArray(a);b=b?b:t.circumcenter(a);a=a[0].$subtract(b).magnitude();return B.fromCenter(b,a)};var q=function(){};q.centroid=function(a){return z.centroid(a)};q.rectangle=function(a,b,c){return p.corners(p.fromCenter(a,b,c))};q.fromCenter=
function(a,b,c){for(var d=new n,e=0;e<c;e++){var f=2*Math.PI*e/c;d.push((new k(Math.cos(f)*b,Math.sin(f)*b)).add(a))}return d};q.lineAt=function(a,b){a=g.iterToArray(a);if(0>b||b>=a.length)throw Error("index out of the Polygon's range");return new n(a[b],b===a.length-1?a[0]:a[b+1])};q.lines=function(a,b){b=void 0===b?!0:b;a=g.iterToArray(a);if(2>a.length)return x(new n,2);var c=g.split(a,2,1);b&&c.push(new n(a[a.length-1],a[0]));return c.map(function(d){return d})};q.midpoints=function(a,b,c){c=void 0===
c?.5:c;return q.lines(a,void 0===b?!1:b).map(function(d){return z.interpolate(d[0],d[1],c)})};q.adjacentSides=function(a,b,c){c=void 0===c?!1:c;a=g.iterToArray(a);if(2>a.length)return x(new n,2);if(0>b||b>=a.length)return c=new n,g.warn("Index "+(void 0===b?"":b)+" is out of bound in Group",c);var d=[],e=b-1;c&&0>e&&(e=a.length-1);0<=e&&d.push(new n(a[b],a[e]));e=b+1;c&&e>a.length-1&&(e=0);e<=a.length-1&&d.push(new n(a[b],a[e]));return d};q.bisector=function(a,b){b=q.adjacentSides(a,b,!0);if(2<=b.length)return a=
b[0][1].$subtract(b[0][0]).unit(),b=b[1][1].$subtract(b[1][0]).unit(),a.add(b).divide(2)};q.perimeter=function(a,b){a=q.lines(a,void 0===b?!1:b);b=0;for(var c=k.make(a.length,0),d=0,e=a.length;d<e;d++){var f=A.magnitude(a[d]);b+=f;c[d]=f}return{total:b,segments:c}};q.area=function(a){a=g.iterToArray(a);if(3>a.length)return x(new n,3);for(var b=function(f,h){return f[0]*h[1]-f[1]*h[0]},c=0,d=0,e=a.length;d<e;d++)c=d<a.length-1?c+b(a[d],a[d+1]):c+b(a[d],a[0]);return Math.abs(c/2)};q.convexHull=function(a,
b){b=void 0===b?!1:b;var c=g.iterToArray(a);if(3>c.length)return x(new n,3);b||(c=c.slice(),c.sort(function(y,G){return y[0]-G[0]}));var d=function(y,G,J){return 0<(G[0]-y[0])*(J[1]-y[1])-(J[0]-y[0])*(G[1]-y[1])};b=[];a=c.length-2;var e=a+3;b[a]=c[2];b[e]=c[2];d(c[0],c[1],c[2])?(b[a+1]=c[0],b[a+2]=c[1]):(b[a+1]=c[1],b[a+2]=c[0]);for(var f=3,h=c.length;f<h;f++){var u=c[f];if(!d(b[a],b[a+1],u)||!d(b[e-1],b[e],u)){for(;!d(b[a],b[a+1],u);)a+=1;--a;for(b[a]=u;!d(b[e-1],b[e],u);)--e;e+=1;b[e]=u}}c=new n;
for(d=0;d<e-a;d++)c.push(b[a+d]);return c};q.network=function(a,b){b=void 0===b?0:b;a=g.iterToArray(a);for(var c=[],d=0,e=a.length;d<e;d++)d!=b&&c.push(new n(a[b],a[d]));return c};q.nearestPt=function(a,b){var c=Number.MAX_VALUE,d=-1,e=0;a=$jscomp.makeIterator(a);for(var f=a.next();!f.done;f=a.next())f=f.value.$subtract(b).magnitudeSq(),f<c&&(c=f,d=e),e++;return d};q.projectAxis=function(a,b){a=g.iterToArray(a);for(var c=b.dot(a[0]),d=new k(c,c),e=1,f=a.length;e<f;e++)c=b.dot(a[e]),d=new k(Math.min(c,
d[0]),Math.max(c,d[1]));return d};q._axisOverlap=function(a,b,c){a=q.projectAxis(a,c);b=q.projectAxis(b,c);return a[0]<b[0]?b[0]-a[1]:a[0]-b[1]};q.hasIntersectPoint=function(a,b){a=g.iterToArray(a);for(var c=!1,d=0,e=a.length;d<e;d++){var f=q.lineAt(a,d);f[0][1]>b[1]!=f[1][1]>b[1]&&b[0]<(f[1][0]-f[0][0])*(b[1]-f[0][1])/(f[1][1]-f[0][1])+f[0][0]&&(c=!c)}return c};q.hasIntersectCircle=function(a,b){a=g.iterToArray(a);var c=g.iterToArray(b),d={which:-1,dist:0,normal:null,edge:null,vertex:null},e=c[0];
c=c[1][0];for(var f=Number.MAX_SAFE_INTEGER,h=0,u=a.length;h<u;h++){var y=q.lineAt(a,h),G=(new k(y[0].y-y[1].y,y[1].x-y[0].x)).unit(),J=new n(e.$add(G.$multiply(c)),e.$subtract(G.$multiply(c)));J=q._axisOverlap(a,J,G);if(0<J)return null;Math.abs(J)<f&&(p.withinBound(y,A.perpendicularFromPt(y,e))||0<B.intersectLine2D(b,y).length)&&(d.edge=y,d.normal=G,f=Math.abs(J),d.which=h)}if(!d.edge)return null;0>e.$subtract(q.centroid(a)).dot(d.normal)&&d.normal.multiply(-1);d.dist=f;d.vertex=e;return d};q.hasIntersectPolygon=
function(a,b){a=g.iterToArray(a);var c=g.iterToArray(b);b={which:-1,dist:0,normal:new k,edge:new n,vertex:new k};for(var d=Number.MAX_SAFE_INTEGER,e=0,f=a.length+c.length;e<f;e++){var h=e<a.length?q.lineAt(a,e):q.lineAt(c,e-a.length),u=(new k(h[0].y-h[1].y,h[1].x-h[0].x)).unit(),y=q._axisOverlap(a,c,u);if(0<y)return null;Math.abs(y)<d&&(b.edge=h,b.normal=u,d=Math.abs(y),b.which=e<a.length?0:1)}b.dist=d;d=0===b.which?c:a;a=0===b.which?a:c;c=q.centroid(d);a=q.centroid(a);0>c.$subtract(a).dot(b.normal)&&
b.normal.multiply(-1);c=Number.MAX_SAFE_INTEGER;e=0;for(f=d.length;e<f;e++)h=b.normal.dot(d[e].$subtract(a)),h<c&&(c=h,b.vertex=d[e]);return b};q.intersectPolygon2D=function(a,b){a=g.iterToArray(a);b=g.iterToArray(b);a=q.lines(a);for(var c=[],d=0,e=a.length;d<e;d++){var f=A.intersectPolygon2D(a[d],b,!1);f&&c.push(f)}return g.flatten(c,!0)};q.toRects=function(a){var b=[];a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next())b.push(z.boundingBox(c.value));a=g.flatten(b,!1);b.unshift(z.boundingBox(a));
return b};var v=function(){};v.getSteps=function(a){for(var b=new n,c=0;c<=a;c++){var d=c/a;b.push(new k(d*d*d,d*d,d,1))}return b};v.controlPoints=function(a,b,c){b=void 0===b?0:b;c=void 0===c?!1:c;var d=g.iterToArray(a);if(b>d.length-1)return new n;a=function(f){return f<d.length-1?f:d.length-1};var e=d[b];b=c?b:b+1;return new n(e,d[a(b++)],d[a(b++)],d[a(b++)])};v._calcPt=function(a,b){var c=a.reduce(function(e,f,h){return e+f.x*b[h]},0),d=a.reduce(function(e,f,h){return e+f.y*b[h]},0);return 2<
a[0].length?(a=a.reduce(function(e,f,h){return e+f.z*b[h]},0),new k(c,d,a)):new k(c,d)};v.catmullRom=function(a,b){b=void 0===b?10:b;a=g.iterToArray(a);if(2>a.length)return new n;for(var c=new n,d=v.getSteps(b),e=v.controlPoints(a,0,!0),f=0;f<=b;f++)c.push(v.catmullRomStep(d[f],e));for(e=0;e<a.length-2;)if(f=v.controlPoints(a,e),0<f.length){for(var h=0;h<=b;h++)c.push(v.catmullRomStep(d[h],f));e++}return c};v.catmullRomStep=function(a,b){var c=new n(new k(-.5,1,-.5,0),new k(1.5,-2.5,0,1),new k(-1.5,
2,.5,0),new k(.5,-.5,0,0));return v._calcPt(b,r.multiply([a],c,!0)[0])};v.cardinal=function(a,b,c){b=void 0===b?10:b;c=void 0===c?.5:c;a=g.iterToArray(a);if(2>a.length)return new n;for(var d=new n,e=v.getSteps(b),f=v.controlPoints(a,0,!0),h=0;h<=b;h++)d.push(v.cardinalStep(e[h],f,c));for(f=0;f<a.length-2;)if(h=v.controlPoints(a,f),0<h.length){for(var u=0;u<=b;u++)d.push(v.cardinalStep(e[u],h,c));f++}return d};v.cardinalStep=function(a,b,c){c=void 0===c?.5:c;var d=new n(new k(-1,2,-1,0),new k(-1,1,
0,0),new k(1,-2,1,0),new k(1,-1,0,0));d=r.multiply([a],d,!0)[0].multiply(c);c=2*a[0]-3*a[1]+1;a=-2*a[0]+3*a[1];d=v._calcPt(b,d);d.x+=c*b[1].x+a*b[2].x;d.y+=c*b[1].y+a*b[2].y;2<d.length&&(d.z+=c*b[1].z+a*b[2].z);return d};v.bezier=function(a,b){b=void 0===b?10:b;a=g.iterToArray(a);if(4>a.length)return new n;for(var c=new n,d=v.getSteps(b),e=0;e<a.length-3;){var f=v.controlPoints(a,e);if(0<f.length){for(var h=0;h<=b;h++)c.push(v.bezierStep(d[h],f));e+=3}}return c};v.bezierStep=function(a,b){var c=new n(new k(-1,
3,-3,1),new k(3,-6,3,0),new k(-3,3,0,0),new k(1,0,0,0));return v._calcPt(b,r.multiply([a],c,!0)[0])};v.bspline=function(a,b,c){b=void 0===b?10:b;c=void 0===c?1:c;a=g.iterToArray(a);if(2>a.length)return new n;for(var d=new n,e=v.getSteps(b),f=0;f<a.length-3;){var h=v.controlPoints(a,f);if(0<h.length){if(1!==c)for(var u=0;u<=b;u++)d.push(v.bsplineTensionStep(e[u],h,c));else for(u=0;u<=b;u++)d.push(v.bsplineStep(e[u],h));f++}}return d};v.bsplineStep=function(a,b){var c=new n(new k(-.16666666666666666,
.5,-.5,.16666666666666666),new k(.5,-1,0,.6666666666666666),new k(-.5,.5,.5,.16666666666666666),new k(.16666666666666666,0,0,0));return v._calcPt(b,r.multiply([a],c,!0)[0])};v.bsplineTensionStep=function(a,b,c){c=void 0===c?1:c;var d=new n(new k(-.16666666666666666,.5,-.5,.16666666666666666),new k(-1.5,2,0,-.3333333333333333),new k(1.5,-2.5,.5,.16666666666666666),new k(.16666666666666666,0,0,0));d=r.multiply([a],d,!0)[0].multiply(c);c=2*a[0]-3*a[1]+1;a=-2*a[0]+3*a[1];d=v._calcPt(b,d);d.x+=c*b[1].x+
a*b[2].x;d.y+=c*b[1].y+a*b[2].y;2<d.length&&(d.z+=c*b[1].z+a*b[2].z);return d};var D=function(){};D.equals=function(a,b,c){return Math.abs(a-b)<(void 0===c?1E-5:c)};D.lerp=function(a,b,c){return(1-c)*a+c*b};D.clamp=function(a,b,c){return Math.max(b,Math.min(c,a))};D.boundValue=function(a,b,c){var d=Math.abs(c-b);a%=d;a>c?a-=d:a<b&&(a+=d);return a};D.within=function(a,b,c){return a>=Math.min(b,c)&&a<=Math.max(b,c)};D.randomRange=function(a,b){b=void 0===b?0:b;return a+Math.random()*(a>b?a-b:b-a)};
D.randomPt=function(a,b){var c=new k(a.length),d=b?m.subtract(b,a):a;a=b?a:(new k(a.length)).fill(0);b=0;for(var e=c.length;b<e;b++)c[b]=Math.random()*d[b]+a[b];return c};D.normalizeValue=function(a,b,c){var d=Math.min(b,c);return(a-d)/(Math.max(b,c)-d)};D.sum=function(a){a=g.iterToArray(a);for(var b=new k(a[0]),c=1,d=a.length;c<d;c++)m.add(b,a[c]);return b};D.average=function(a){a=g.iterToArray(a);return D.sum(a).divide(a.length)};D.cycle=function(a,b){b=void 0===b?H.sineInOut:b;return b(.5<a?2-
2*a:2*a)};D.mapToRange=function(a,b,c,d,e){if(b==c)throw Error("[currMin, currMax] must define a range that is not zero");var f=Math.min(d,e);d=Math.max(d,e);return D.normalizeValue(a,b,c)*(d-f)+f};var z=function(){};z.boundAngle=function(a){return D.boundValue(a,0,360)};z.boundRadian=function(a){return D.boundValue(a,0,6.283185307179586)};z.toRadian=function(a){return.017453292519943295*a};z.toDegree=function(a){return 57.29577951308232*a};z.boundingBox=function(a){a=$jscomp.makeIterator(a);for(var b=
a.next();!b.done;b=a.next())if(b=b.value,void 0==c){var c=b.clone();var d=b.clone()}else c=c.$min(b),d=d.$max(b);return new n(c,d)};z.centroid=function(a){return D.average(a)};z.anchor=function(a,b,c){b=void 0===b?0:b;c="to"==(void 0===c?"to":c)?"subtract":"add";for(var d=0,e=$jscomp.makeIterator(a),f=e.next();!f.done;f=e.next()){f=f.value;if("number"==typeof b){if(b!==d)f[c](a[b])}else f[c](b);d++}};z.interpolate=function(a,b,c){c=void 0===c?.5:c;for(var d=Math.min(a.length,b.length),e=k.make(d),
f=0;f<d;f++)e[f]=a[f]*(1-c)+b[f]*c;return e};z.perpendicular=function(a,b){b=void 0===b?"xy":b;var c=b[1];b=b[0];a=new k(a);var d=new k(a);d[b]=-a[c];d[c]=a[b];var e=new k(a);e[b]=a[c];e[c]=-a[b];return new n(d,e)};z.isPerpendicular=function(a,b){return 0===(new k(a)).dot(b)};z.withinBound=function(a,b,c){for(var d=0,e=Math.min(a.length,b.length,c.length);d<e;d++)if(!D.within(a[d],b[d],c[d]))return!1;return!0};z.sortEdges=function(a){a=g.iterToArray(a);var b=z.boundingBox(a),c=b[1].add(b[0]).divide(2);
return a.sort(function(d,e){if(2>d.length||2>e.length)throw Error("Pt dimension cannot be less than 2");d=d.$subtract(c);e=e.$subtract(c);if(0<=d[0]&&0>e[0])return 1;if(0>d[0]&&0<=e[0])return-1;if(0==d[0]&&0==e[0])return 0<=d[1]||0<=e[1]?d[1]>e[1]?1:-1:e[1]>d[1]?1:-1;var f=d.$cross2D(e);return 0>f?1:0<f?-1:d[0]*d[0]+d[1]*d[1]>e[0]*e[0]+e[1]*e[1]?1:-1})};z.scale=function(a,b,c){a=g.iterToArray(void 0!==a[0]&&"number"==typeof a[0]?[a]:a);b="number"==typeof b?k.make(a[0].length,b):b;c||(c=k.make(a[0].length,
0));for(var d=0,e=a.length;d<e;d++)for(var f=a[d],h=0,u=f.length;h<u;h++)f[h]=c&&c[h]?c[h]+(f[h]-c[h])*b[h]:f[h]*b[h];return z};z.rotate2D=function(a,b,c,d){a=g.iterToArray(void 0!==a[0]&&"number"==typeof a[0]?[a]:a);var e=c?r.rotateAt2DMatrix:r.rotate2DMatrix;c||(c=k.make(a[0].length,0));var f=Math.cos(b);b=Math.sin(b);for(var h=0,u=a.length;h<u;h++){var y=d?a[h].$take(d):a[h];y.to(r.transform2D(y,e(f,b,c)));if(d)for(var G=0;G<d.length;G++)a[h][d[G]]=y[G]}return z};z.shear2D=function(a,b,c,d){a=
g.iterToArray(void 0!==a[0]&&"number"==typeof a[0]?[a]:a);var e="number"==typeof b?[b,b]:b;c||(c=k.make(a[0].length,0));b=c?r.shearAt2DMatrix:r.shear2DMatrix;var f=Math.tan(e[0]);e=Math.tan(e[1]);for(var h=0,u=a.length;h<u;h++){var y=d?a[h].$take(d):a[h];y.to(r.transform2D(y,b(f,e,c)));if(d)for(var G=0;G<d.length;G++)a[h][d[G]]=y[G]}return z};z.reflect2D=function(a,b,c){a=g.iterToArray(void 0!==a[0]&&"number"==typeof a[0]?[a]:a);b=g.iterToArray(b);b=r.reflectAt2DMatrix(b[0],b[1]);for(var d=0,e=a.length;d<
e;d++){var f=c?a[d].$take(c):a[d];f.to(r.transform2D(f,b));if(c)for(var h=0;h<c.length;h++)a[d][c[h]]=f[h]}return z};z.cosTable=function(){for(var a=new Float64Array(360),b=0;360>b;b++)a[b]=Math.cos(b*Math.PI/180);return{table:a,cos:function(c){return a[Math.floor(z.boundAngle(z.toDegree(c)))]}}};z.sinTable=function(){for(var a=new Float64Array(360),b=0;360>b;b++)a[b]=Math.sin(b*Math.PI/180);return{table:a,sin:function(c){return a[Math.floor(z.boundAngle(z.toDegree(c)))]}}};var H=function(){};H.linear=
function(a,b){return(void 0===b?1:b)*a};H.quadraticIn=function(a,b){return(void 0===b?1:b)*a*a};H.quadraticOut=function(a,b){return-(void 0===b?1:b)*a*(a-2)};H.quadraticInOut=function(a,b){b=void 0===b?1:b;var c=2*a;return.5>a?b/2*a*a*4:-b/2*((c-1)*(c-3)-1)};H.cubicIn=function(a,b){return(void 0===b?1:b)*a*a*a};H.cubicOut=function(a,b){--a;return(void 0===b?1:b)*(a*a*a+1)};H.cubicInOut=function(a,b){b=void 0===b?1:b;var c=2*a;return.5>a?b/2*c*c*c:b/2*((c-2)*(c-2)*(c-2)+2)};H.exponentialIn=function(a,
b,c){return(void 0===b?1:b)*Math.pow(a,1/(void 0===c?.25:c))};H.exponentialOut=function(a,b,c){return(void 0===b?1:b)*Math.pow(a,void 0===c?.25:c)};H.sineIn=function(a,b){b=void 0===b?1:b;return-b*Math.cos(1.5707963267948966*a)+b};H.sineOut=function(a,b){return(void 0===b?1:b)*Math.sin(1.5707963267948966*a)};H.sineInOut=function(a,b){return-(void 0===b?1:b)/2*(Math.cos(Math.PI*a)-1)};H.cosineApprox=function(a,b){a*=a;var c=a*a;return(void 0===b?1:b)*(4*c*a/9-17*c/9+22*a/9)};H.circularIn=function(a,
b){return-(void 0===b?1:b)*(Math.sqrt(1-a*a)-1)};H.circularOut=function(a,b){--a;return(void 0===b?1:b)*Math.sqrt(1-a*a)};H.circularInOut=function(a,b){b=void 0===b?1:b;var c=2*a;return.5>a?-b/2*(Math.sqrt(1-c*c)-1):b/2*(Math.sqrt(1-(c-2)*(c-2))+1)};H.elasticIn=function(a,b,c){c=void 0===c?.7:c;--a;return(void 0===b?1:b)*-Math.pow(2,10*a)*Math.sin(6.283185307179586*(a-c/6.283185307179586*1.5707963267948966)/c)};H.elasticOut=function(a,b,c){b=void 0===b?1:b;c=void 0===c?.7:c;return b*Math.pow(2,-10*
a)*Math.sin(6.283185307179586*(a-c/6.283185307179586*1.5707963267948966)/c)+b};H.elasticInOut=function(a,b,c){b=void 0===b?1:b;c=void 0===c?.6:c;var d=2*a,e=c/6.283185307179586*1.5707963267948966;if(.5>a)return--d,-.5*b*Math.pow(2,10*d)*Math.sin(6.283185307179586*(d-e)/c);--d;return.5*b*Math.pow(2,-10*d)*Math.sin(6.283185307179586*(d-e)/c)+b};H.bounceIn=function(a,b){b=void 0===b?1:b;return b-H.bounceOut(1-a,b)};H.bounceOut=function(a,b){b=void 0===b?1:b;if(a<1/2.75)return 7.5625*b*a*a;if(a<2/2.75)return a-=
1.5/2.75,b*(7.5625*a*a+.75);if(a<2.5/2.75)return a-=2.25/2.75,b*(7.5625*a*a+.9375);a-=2.625/2.75;return b*(7.5625*a*a+.984375)};H.bounceInOut=function(a,b){b=void 0===b?1:b;return.5>a?H.bounceIn(2*a,b)/2:H.bounceOut(2*a-1,b)/2+b/2};H.sigmoid=function(a,b,c){return(void 0===b?1:b)/(1+Math.exp(-((void 0===c?10:c)*(a-.5))))};H.logSigmoid=function(a,b,c){c=Math.max(1E-4,Math.min(.9999,void 0===c?.7:c));c=1/(1-c);var d=1/(1+Math.exp(c));return(void 0===b?1:b)*(1/(1+Math.exp((a-.5)*c*-2))-d)/(1/(1+Math.exp(-c))-
d)};H.seat=function(a,b,c){b=void 0===b?1:b;c=void 0===c?.5:c;return.5>a?b*Math.pow(2*a,1-c)/2:b*(1-Math.pow(2*(1-a),1-c)/2)};H.quadraticBezier=function(a,b,c){c=void 0===c?[.05,.95]:c;var d="number"!=typeof c?c[0]:c;c="number"!=typeof c?c[1]:.5;var e=1-2*d;0===e&&(e=1E-4);a=(Math.sqrt(d*d+e*a)-d)/e;return(void 0===b?1:b)*((1-2*c)*a*a+2*c*a)};H.cubicBezier=function(a,b,c,d){b=void 0===b?1:b;c=void 0===c?[.1,.7]:c;d=void 0===d?[.9,.2]:d;c=new n(new k(0,0),new k(c),new k(d),new k(1,1));return b*v.bezierStep(new k(a*
a*a,a*a,a,1),v.controlPoints(c)).y};H.quadraticTarget=function(a,b,c){c=void 0===c?[.2,.35]:c;var d=Math.min(.9999,Math.max(1E-4,c[0]));c=Math.min(1,Math.max(0,c[1]));var e=(1-c)/(1-d)-c/d;return(void 0===b?1:b)*Math.min(1,Math.max(0,e*a*a-(e*d*d-c)/d*a))};H.cliff=function(a,b,c){return a>(void 0===c?.5:c)?void 0===b?1:b:0};H.step=function(a,b,c,d,e){for(var f=[],h=4;h<arguments.length;++h)f[h-4]=arguments[h];h=1/b;return a.apply(null,[Math.floor(c/h)*h,d].concat($jscomp.arrayFromIterable(f)))};var k=
function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return 1===b.length&&"number"==typeof b[0]?$jscomp.construct(Float32Array,[b[0]],this.constructor):$jscomp.construct(Float32Array,[0<b.length?g.getArgs(b):[0,0]],this.constructor)};$jscomp.inherits(k,Float32Array);k.make=function(a,b,c){b=void 0===b?0:b;c=void 0===c?!1:c;a=new Float32Array(a);b&&a.fill(b);if(c)for(b=0,c=a.length;b<c;b++)a[b]*=Math.random();return new k(a)};k.prototype.clone=function(){return new k(this)};k.prototype.equals=
function(a,b){b=void 0===b?1E-6:b;for(var c=0,d=this.length;c<d;c++)if(Math.abs(this[c]-a[c])>b)return!1;return!0};k.prototype.to=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];b=g.getArgs(b);c=0;for(var d=Math.min(this.length,b.length);c<d;c++)this[c]=b[c];return this};k.prototype.$to=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];var d;return(d=this.clone()).to.apply(d,$jscomp.arrayFromIterable(b))};k.prototype.toAngle=function(a,b,c){c=void 0===
c?!1:c;b=void 0!=b?b:this.magnitude();a=[Math.cos(a)*b,Math.sin(a)*b];return c?this.add(a):this.to(a)};k.prototype.op=function(a){var b=this;return function(c){for(var d=[],e=0;e<arguments.length;++e)d[e-0]=arguments[e];return a.apply(null,[b].concat($jscomp.arrayFromIterable(d)))}};k.prototype.ops=function(a){for(var b=[],c=0,d=a.length;c<d;c++)b.push(this.op(a[c]));return b};k.prototype.$take=function(a){for(var b=[],c=0,d=a.length;c<d;c++)b.push(this[a[c]]||0);return new k(b)};k.prototype.$concat=
function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return new k(this.toArray().concat(g.getArgs(b)))};k.prototype.add=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];1===b.length&&"number"==typeof b[0]?m.add(this,b[0]):m.add(this,g.getArgs(b));return this};k.prototype.$add=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];var d;return(d=this.clone()).add.apply(d,$jscomp.arrayFromIterable(b))};k.prototype.subtract=function(a){for(var b=
[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];1===b.length&&"number"==typeof b[0]?m.subtract(this,b[0]):m.subtract(this,g.getArgs(b));return this};k.prototype.$subtract=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];var d;return(d=this.clone()).subtract.apply(d,$jscomp.arrayFromIterable(b))};k.prototype.multiply=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];1===b.length&&"number"==typeof b[0]?m.multiply(this,b[0]):m.multiply(this,g.getArgs(b));
return this};k.prototype.$multiply=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];var d;return(d=this.clone()).multiply.apply(d,$jscomp.arrayFromIterable(b))};k.prototype.divide=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];1===b.length&&"number"==typeof b[0]?m.divide(this,b[0]):m.divide(this,g.getArgs(b));return this};k.prototype.$divide=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];var d;return(d=this.clone()).divide.apply(d,
$jscomp.arrayFromIterable(b))};k.prototype.magnitudeSq=function(){return m.dot(this,this)};k.prototype.magnitude=function(){return m.magnitude(this)};k.prototype.unit=function(a){m.unit(this,a);return this};k.prototype.$unit=function(a){return this.clone().unit(a)};k.prototype.dot=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return m.dot(this,g.getArgs(b))};k.prototype.$cross2D=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return m.cross2D(this,
g.getArgs(b))};k.prototype.$cross=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return m.cross(this,g.getArgs(b))};k.prototype.$project=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return this.$multiply(this.dot.apply(this,$jscomp.arrayFromIterable(b))/this.magnitudeSq())};k.prototype.projectScalar=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return this.dot.apply(this,$jscomp.arrayFromIterable(b))/this.magnitude()};k.prototype.abs=
function(){m.abs(this);return this};k.prototype.$abs=function(){return this.clone().abs()};k.prototype.floor=function(){m.floor(this);return this};k.prototype.$floor=function(){return this.clone().floor()};k.prototype.ceil=function(){m.ceil(this);return this};k.prototype.$ceil=function(){return this.clone().ceil()};k.prototype.round=function(){m.round(this);return this};k.prototype.$round=function(){return this.clone().round()};k.prototype.minValue=function(){return m.min(this)};k.prototype.maxValue=
function(){return m.max(this)};k.prototype.$min=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];b=g.getArgs(b);c=this.clone();for(var d=0,e=Math.min(this.length,b.length);d<e;d++)c[d]=Math.min(this[d],b[d]);return c};k.prototype.$max=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];b=g.getArgs(b);c=this.clone();for(var d=0,e=Math.min(this.length,b.length);d<e;d++)c[d]=Math.max(this[d],b[d]);return c};k.prototype.angle=function(a){a=void 0===a?"xy":a;
return Math.atan2(this[a[1]],this[a[0]])};k.prototype.angleBetween=function(a,b){b=void 0===b?"xy":b;return z.boundRadian(this.angle(b))-z.boundRadian(a.angle(b))};k.prototype.scale=function(a,b){z.scale(this,a,b||k.make(this.length,0));return this};k.prototype.rotate2D=function(a,b,c){z.rotate2D(this,a,b||k.make(this.length,0),c);return this};k.prototype.shear2D=function(a,b,c){z.shear2D(this,a,b||k.make(this.length,0),c);return this};k.prototype.reflect2D=function(a,b){z.reflect2D(this,a,b);return this};
k.prototype.toString=function(){return"Pt("+this.join(", ")+")"};k.prototype.toArray=function(){return[].slice.call(this)};k.prototype.toGroup=function(){return new n(k.make(this.length),this.clone())};k.prototype.toBound=function(){return new N(k.make(this.length),this.clone())};$jscomp.global.Object.defineProperties(k.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id},set:function(a){this._id=a}},x:{configurable:!0,enumerable:!0,get:function(){return this[0]},set:function(a){this[0]=
a}},y:{configurable:!0,enumerable:!0,get:function(){return this[1]},set:function(a){this[1]=a}},z:{configurable:!0,enumerable:!0,get:function(){return this[2]},set:function(a){this[2]=a}},w:{configurable:!0,enumerable:!0,get:function(){return this[3]},set:function(a){this[3]=a}}});var n=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return $jscomp.construct(Array,[].concat($jscomp.arrayFromIterable(b)),this.constructor)};$jscomp.inherits(n,Array);n.prototype.clone=function(){for(var a=
new n,b=0,c=this.length;b<c;b++)a.push(this[b].clone());return a};n.fromArray=function(a){var b=new n;a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next())c=c.value,c=c instanceof k?c:new k(c),b.push(c);return b};n.fromPtArray=function(a){return n.from(a)};n.prototype.split=function(a,b,c){return g.split(this,a,b,void 0===c?!1:c)};n.prototype.insert=function(a,b){n.prototype.splice.apply(this,[void 0===b?0:b,0].concat($jscomp.arrayFromIterable(a)));return this};n.prototype.remove=function(a,
b){a=void 0===a?0:a;b=void 0===b?1:b;return n.prototype.splice.apply(this,0>a?[-1*a-1,b]:[a,b])};n.prototype.segments=function(a,b,c){return this.split(void 0===a?2:a,void 0===b?1:b,void 0===c?!1:c)};n.prototype.lines=function(){return this.segments(2,1)};n.prototype.centroid=function(){return z.centroid(this)};n.prototype.boundingBox=function(){return z.boundingBox(this)};n.prototype.anchorTo=function(a){z.anchor(this,void 0===a?0:a,"to")};n.prototype.anchorFrom=function(a){z.anchor(this,void 0===
a?0:a,"from")};n.prototype.op=function(a){var b=this;return function(c){for(var d=[],e=0;e<arguments.length;++e)d[e-0]=arguments[e];return a.apply(null,[b].concat($jscomp.arrayFromIterable(d)))}};n.prototype.ops=function(a){for(var b=[],c=0,d=a.length;c<d;c++)b.push(this.op(a[c]));return b};n.prototype.interpolate=function(a){a=D.clamp(a,0,1);var b=1/(this.length-1),c=Math.floor(a/b);return z.interpolate(this[c],this[Math.min(this.length-1,c+1)],(a-c*b)*(this.length-1))};n.prototype.moveBy=function(a){for(var b=
[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return this.add.apply(this,$jscomp.arrayFromIterable(b))};n.prototype.moveTo=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];b=(new k(g.getArgs(b))).subtract(this[0]);this.moveBy(b);return this};n.prototype.scale=function(a,b){for(var c=0,d=this.length;c<d;c++)z.scale(this[c],a,b||this[0]);return this};n.prototype.rotate2D=function(a,b,c){for(var d=0,e=this.length;d<e;d++)z.rotate2D(this[d],a,b||this[0],c);return this};n.prototype.shear2D=
function(a,b,c){for(var d=0,e=this.length;d<e;d++)z.shear2D(this[d],a,b||this[0],c);return this};n.prototype.reflect2D=function(a,b){for(var c=0,d=this.length;c<d;c++)z.reflect2D(this[c],a,b);return this};n.prototype.sortByDimension=function(a,b){b=void 0===b?!1:b;return this.sort(function(c,d){return b?d[a]-c[a]:c[a]-d[a]})};n.prototype.forEachPt=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];if(!this[0][a])return g.warn(a+" is not a function of Pt"),this;d=0;for(var e=
this.length;d<e;d++)this[d]=this[d][a].apply(this[d],$jscomp.arrayFromIterable(c));return this};n.prototype.add=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return this.forEachPt.apply(this,["add"].concat($jscomp.arrayFromIterable(b)))};n.prototype.subtract=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return this.forEachPt.apply(this,["subtract"].concat($jscomp.arrayFromIterable(b)))};n.prototype.multiply=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-
0]=arguments[c];return this.forEachPt.apply(this,["multiply"].concat($jscomp.arrayFromIterable(b)))};n.prototype.divide=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return this.forEachPt.apply(this,["divide"].concat($jscomp.arrayFromIterable(b)))};n.prototype.$matrixAdd=function(a){return r.add(this,a)};n.prototype.$matrixMultiply=function(a,b,c){return r.multiply(this,a,void 0===b?!1:b,void 0===c?!1:c)};n.prototype.zipSlice=function(a,b){return r.zipSlice(this,a,void 0===
b?!1:b)};n.prototype.$zip=function(a,b){return r.zip(this,a,void 0===b?!1:b)};n.prototype.toString=function(){return"Group[ "+this.reduce(function(a,b){return a+b.toString()+" "},"")+" ]"};$jscomp.global.Object.defineProperties(n.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id},set:function(a){this._id=a}},p1:{configurable:!0,enumerable:!0,get:function(){return this[0]}},p2:{configurable:!0,enumerable:!0,get:function(){return this[1]}},p3:{configurable:!0,enumerable:!0,
get:function(){return this[2]}},p4:{configurable:!0,enumerable:!0,get:function(){return this[3]}},q1:{configurable:!0,enumerable:!0,get:function(){return this[this.length-1]}},q2:{configurable:!0,enumerable:!0,get:function(){return this[this.length-2]}},q3:{configurable:!0,enumerable:!0,get:function(){return this[this.length-3]}},q4:{configurable:!0,enumerable:!0,get:function(){return this[this.length-4]}}});var N=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];b=n.apply(this,
[].concat($jscomp.arrayFromIterable(b)))||this;b._center=new k;b._size=new k;b._topLeft=new k;b._bottomRight=new k;b._inited=!1;b.init();return b};$jscomp.inherits(N,n);N.fromBoundingRect=function(a){var b=new N(new k(a.left||0,a.top||0),new k(a.right||0,a.bottom||0));a.width&&a.height&&(b.size=new k(a.width,a.height));return b};N.fromGroup=function(a){a=g.iterToArray(a);if(2>a.length)throw Error("Cannot create a Bound from a group that has less than 2 Pt");return new N(a[0],a[a.length-1])};N.prototype.init=
function(){this.p1&&(this._size=this.p1.clone(),this._inited=!0);if(this.p1&&this.p2){var a=this.p1,b=this.p2;this.topLeft=a.$min(b);this._bottomRight=a.$max(b);this._updateSize();this._inited=!0}};N.prototype.clone=function(){return new N(this._topLeft.clone(),this._bottomRight.clone())};N.prototype._updateSize=function(){this._size=this._bottomRight.$subtract(this._topLeft).abs();this._updateCenter()};N.prototype._updateCenter=function(){this._center=this._size.$multiply(.5).add(this._topLeft)};
N.prototype._updatePosFromTop=function(){this._bottomRight=this._topLeft.$add(this._size);this._updateCenter()};N.prototype._updatePosFromBottom=function(){this._topLeft=this._bottomRight.$subtract(this._size);this._updateCenter()};N.prototype._updatePosFromCenter=function(){var a=this._size.$multiply(.5);this._topLeft=this._center.$subtract(a);this._bottomRight=this._center.$add(a)};N.prototype.update=function(){this._topLeft=this[0];this._bottomRight=this[1];this._updateSize();return this};$jscomp.global.Object.defineProperties(N.prototype,
{size:{configurable:!0,enumerable:!0,get:function(){return new k(this._size)},set:function(a){this._size=new k(a);this._updatePosFromTop()}},center:{configurable:!0,enumerable:!0,get:function(){return new k(this._center)},set:function(a){this._center=new k(a);this._updatePosFromCenter()}},topLeft:{configurable:!0,enumerable:!0,get:function(){return new k(this._topLeft)},set:function(a){this._topLeft=new k(a);this[0]=this._topLeft;this._updateSize()}},bottomRight:{configurable:!0,enumerable:!0,get:function(){return new k(this._bottomRight)},
set:function(a){this._bottomRight=new k(a);this[1]=this._bottomRight;this._updateSize()}},width:{configurable:!0,enumerable:!0,get:function(){return 0<this._size.length?this._size.x:0},set:function(a){this._size.x=a;this._updatePosFromTop()}},height:{configurable:!0,enumerable:!0,get:function(){return 1<this._size.length?this._size.y:0},set:function(a){this._size.y=a;this._updatePosFromTop()}},depth:{configurable:!0,enumerable:!0,get:function(){return 2<this._size.length?this._size.z:0},set:function(a){this._size.z=
a;this._updatePosFromTop()}},x:{configurable:!0,enumerable:!0,get:function(){return this.topLeft.x}},y:{configurable:!0,enumerable:!0,get:function(){return this.topLeft.y}},z:{configurable:!0,enumerable:!0,get:function(){return this.topLeft.z}},inited:{configurable:!0,enumerable:!0,get:function(){return this._inited}}});var K=function(a,b,c,d){c=void 0===c?{}:c;this._holds=new Map;this._group=n.fromArray(a);this._shape=b;this._id=void 0===d?"ui_"+K._counter++:d;this._states=c;this._actions={}};K.fromRectangle=
function(a,b,c){return new this(a,"rectangle",b,c)};K.fromCircle=function(a,b,c){return new this(a,"circle",b,c)};K.fromPolygon=function(a,b,c){return new this(a,"polygon",b,c)};K.fromUI=function(a,b,c){return new this(a.group,a.shape,b||a._states,c)};K.prototype.state=function(a,b){return a?void 0!==b?(this._states[a]=b,this):this._states[a]:null};K.prototype.on=function(a,b){this._actions[a]||(this._actions[a]=[]);return K._addHandler(this._actions[a],b)};K.prototype.off=function(a,b){return this._actions[a]?
void 0===b?(delete this._actions[a],!0):K._removeHandler(this._actions[a],b):!1};K.prototype.listen=function(a,b,c){if(void 0!==this._actions[a]){if(this._within(b)||0<=Array.from(this._holds.values()).indexOf(a))return K._trigger(this._actions[a],this,b,a,c),!0;if(this._actions.all)return K._trigger(this._actions.all,this,b,a,c),!0}return!1};K.prototype.hold=function(a){var b=Math.max.apply(Math,[0].concat($jscomp.arrayFromIterable(Array.from(this._holds.keys()))))+1;this._holds.set(b,a);return b};
K.prototype.unhold=function(a){void 0!==a?this._holds.delete(a):this._holds.clear()};K.track=function(a,b,c,d){for(var e=0,f=a.length;e<f;e++)a[e].listen(b,c,d)};K.prototype.render=function(a){a(this._group,this._states)};K.prototype.toString=function(){return"UI "+this.group.toString};K.prototype._within=function(a){if("rectangle"===this._shape)var b=p.withinBound;else if("circle"===this._shape)b=B.withinBound;else if("polygon"===this._shape)b=q.hasIntersectPoint;else return!1;return b(this._group,
a)};K._trigger=function(a,b,c,d,e){if(a)for(var f=0,h=a.length;f<h;f++)if(a[f])a[f](b,c,d,e)};K._addHandler=function(a,b){return b?(a.push(b),a.length-1):-1};K._removeHandler=function(a,b){if(0<=b&&b<a.length){var c=a.length;a.splice(b,1);return c>a.length}return!1};$jscomp.global.Object.defineProperties(K.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id},set:function(a){this._id=a}},group:{configurable:!0,enumerable:!0,get:function(){return this._group},set:function(a){this._group=
a}},shape:{configurable:!0,enumerable:!0,get:function(){return this._shape},set:function(a){this._shape=a}}});K._counter=0;var L=function(a,b,c,d){c=void 0===c?{}:c;var e=null.call(this,a,b,c,d)||this;e._hoverID=-1;void 0===c.hover&&(e._states.hover=!1);void 0===c.clicks&&(e._states.clicks=0);e.on("up",function(f,h,u,y){e.state("clicks",e._states.clicks+1)});e.on("move",function(f,h,u,y){if(e._within(h)&&!e._states.hover){e.state("hover",!0);K._trigger(e._actions.enter,e,h,"enter",y);var G=e.hold("move");
e._hoverID=e.on("move",function(J,P){e._within(P)||e.state("dragging")||(e.state("hover",!1),K._trigger(e._actions.leave,e,h,"leave",y),e.off("move",e._hoverID),e.unhold(G))})}});return e};$jscomp.inherits(L,null);L.prototype.onClick=function(a){return this.on("up",a)};L.prototype.offClick=function(a){return this.off("up",a)};L.prototype.onContextMenu=function(a){return this.on("contextmenu",a)};L.prototype.offContextMenu=function(a){return this.off("contextmenu",a)};L.prototype.onHover=function(a,
b){var c=[void 0,void 0];a&&(c[0]=this.on("enter",a));b&&(c[1]=this.on("leave",b));return c};L.prototype.offHover=function(a,b){var c=[!1,!1];if(void 0===a||0<=a)c[0]=this.off("enter",a);if(void 0===b||0<=b)c[1]=this.off("leave",b);return c};L=function(a,b,c,d){c=void 0===c?{}:c;var e=null.call(this,a,b,c,d)||this;e._draggingID=-1;e._moveHoldID=-1;e._dropHoldID=-1;e._upHoldID=-1;void 0===c.dragging&&(e._states.dragging=!1);void 0===c.moved&&(e._states.moved=!1);void 0===c.offset&&(e._states.offset=
new Pt);e.on("down",function(f,h,u,y){-1===e._moveHoldID&&(e.state("dragging",!0),e.state("offset",(new Pt(h)).subtract(f.group[0])),e._moveHoldID=e.hold("move"));-1===e._dropHoldID&&(e._dropHoldID=e.hold("drop"));-1===e._upHoldID&&(e._upHoldID=e.hold("up"));-1===e._draggingID&&(e._draggingID=e.on("move",function(G,J){e.state("dragging")&&(K._trigger(e._actions.uidrag,G,J,"uidrag",y),e.state("moved",!0))}))});a=function(f,h,u,y){e.state("dragging",!1);e.off("move",e._draggingID);e._draggingID=-1;
e.unhold(e._moveHoldID);e._moveHoldID=-1;e.unhold(e._dropHoldID);e._dropHoldID=-1;e.unhold(e._upHoldID);e._upHoldID=-1;e.state("moved")&&(K._trigger(e._actions.uidrop,f,h,"uidrop",y),e.state("moved",!1))};e.on("drop",a);e.on("up",a);e.on("out",a);return e};$jscomp.inherits(L,null);L.prototype.onDrag=function(a){return this.on("uidrag",a)};L.prototype.offDrag=function(a){return this.off("uidrag",a)};L.prototype.onDrop=function(a){return this.on("uidrop",a)};L.prototype.offDrop=function(a){return this.off("uidrop",
a)};var V=function(){this.id="space";this.bound=new N;this._time={prev:0,diff:0,end:-1};this.players={};this.playerCount=0;this._animID=-1;this._pause=!1;this._refresh=void 0;this._pointer=new k;this._playing=this._isReady=!1};V.prototype.refresh=function(a){this._refresh=a;return this};V.prototype.add=function(a){a="function"==typeof a?{animate:a}:a;var b=this.playerCount++;b=this.id+b;this.players[b]=a;a.animateID=b;a.resize&&this.bound.inited&&a.resize(this.bound);void 0===this._refresh&&(this._refresh=
!0);return this};V.prototype.remove=function(a){delete this.players[a.animateID];return this};V.prototype.removeAll=function(){this.players={};return this};V.prototype.play=function(a){a=void 0===a?0:a;if(0!==a||-1===this._animID){this._animID=requestAnimationFrame(this.play.bind(this));if(this._pause)return this;this._time.diff=a-this._time.prev;this._time.prev=a;try{this.playItems(a)}catch(b){throw cancelAnimationFrame(this._animID),this._animID=-1,this._playing=!1,b;}return this}};V.prototype.replay=
function(){this._time.end=-1;this.play()};V.prototype.playItems=function(a){this._playing=!0;this._refresh&&this.clear();if(this._isReady)for(var b in this.players)this.players[b].animate&&this.players[b].animate(a,this._time.diff,this);0<=this._time.end&&a>this._time.end&&(cancelAnimationFrame(this._animID),this._animID=-1,this._playing=!1)};V.prototype.pause=function(a){this._pause=(void 0===a?0:a)?!this._pause:!0;return this};V.prototype.resume=function(){this._pause=!1;return this};V.prototype.stop=
function(a){this._time.end=void 0===a?0:a;return this};V.prototype.playOnce=function(a){a=void 0===a?5E3:a;this.play();this.stop(a);return this};V.prototype.render=function(a){this._renderFunc&&this._renderFunc(a,this);return this};$jscomp.global.Object.defineProperties(V.prototype,{customRendering:{configurable:!0,enumerable:!0,set:function(a){this._renderFunc=a},get:function(){return this._renderFunc}},isPlaying:{configurable:!0,enumerable:!0,get:function(){return this._playing}},outerBound:{configurable:!0,
enumerable:!0,get:function(){return this.bound.clone()}},innerBound:{configurable:!0,enumerable:!0,get:function(){return new N(k.make(this.size.length,0),this.size.clone())}},size:{configurable:!0,enumerable:!0,get:function(){return this.bound.size.clone()}},center:{configurable:!0,enumerable:!0,get:function(){return this.size.divide(2)}},width:{configurable:!0,enumerable:!0,get:function(){return this.bound.width}},height:{configurable:!0,enumerable:!0,get:function(){return this.bound.height}}});
var O=function(){var a=V.apply(this,arguments)||this;a._pressed=!1;a._dragged=!1;a._hasMouse=!1;a._hasTouch=!1;return a};$jscomp.inherits(O,V);O.prototype.bindCanvas=function(a,b,c){c=void 0===c?{}:c;this._canvas.addEventListener(a,b,c)};O.prototype.unbindCanvas=function(a,b){this._canvas.removeEventListener(a,b)};O.prototype.bindMouse=function(a){void 0===a||a?(this.bindCanvas("mousedown",this._mouseDown.bind(this)),this.bindCanvas("mouseup",this._mouseUp.bind(this)),this.bindCanvas("mouseover",
this._mouseOver.bind(this)),this.bindCanvas("mouseout",this._mouseOut.bind(this)),this.bindCanvas("mousemove",this._mouseMove.bind(this)),this.bindCanvas("click",this._mouseClick.bind(this)),this.bindCanvas("contextmenu",this._contextMenu.bind(this)),this._hasMouse=!0):(this.unbindCanvas("mousedown",this._mouseDown.bind(this)),this.unbindCanvas("mouseup",this._mouseUp.bind(this)),this.unbindCanvas("mouseover",this._mouseOver.bind(this)),this.unbindCanvas("mouseout",this._mouseOut.bind(this)),this.unbindCanvas("mousemove",
this._mouseMove.bind(this)),this.unbindCanvas("click",this._mouseClick.bind(this)),this.unbindCanvas("contextmenu",this._contextMenu.bind(this)),this._hasMouse=!1);return this};O.prototype.bindTouch=function(a){void 0===a||a?(this.bindCanvas("touchstart",this._touchStart.bind(this),{passive:!0}),this.bindCanvas("touchend",this._mouseUp.bind(this)),this.bindCanvas("touchmove",this._touchMove.bind(this),{passive:!0}),this.bindCanvas("touchcancel",this._mouseOut.bind(this)),this._hasTouch=!0):(this.unbindCanvas("touchstart",
this._touchStart.bind(this)),this.unbindCanvas("touchend",this._mouseUp.bind(this)),this.unbindCanvas("touchmove",this._touchMove.bind(this)),this.unbindCanvas("touchcancel",this._mouseOut.bind(this)),this._hasTouch=!1);return this};O.prototype.touchesToPoints=function(a,b){b=void 0===b?"touches":b;if(!a||!a[b])return[];for(var c=[],d=0;d<a[b].length;d++){var e=a[b].item(d);c.push(new k(e.pageX-this.bound.topLeft.x,e.pageY-this.bound.topLeft.y))}return c};O.prototype._mouseAction=function(a,b){var c=
0,d=0;if(b instanceof MouseEvent)for(var e in this.players){if(this.players.hasOwnProperty(e)){var f=this.players[e];c=b.pageX-this.outerBound.x;d=b.pageY-this.outerBound.y;f.action&&f.action(a,c,d,b)}}else for(f in this.players)if(this.players.hasOwnProperty(f)){e=this.players[f];d=b.changedTouches&&0<b.changedTouches.length;var h=b.changedTouches.item(0);c=d?h.pageX-this.outerBound.x:0;d=d?h.pageY-this.outerBound.y:0;e.action&&e.action(a,c,d,b)}a&&(this._pointer.to(c,d),this._pointer.id=a)};O.prototype._mouseDown=
function(a){this._mouseAction("down",a);this._pressed=!0;return!1};O.prototype._mouseUp=function(a){this._dragged?this._mouseAction("drop",a):this._mouseAction("up",a);return this._dragged=this._pressed=!1};O.prototype._mouseMove=function(a){this._mouseAction("move",a);this._pressed&&(this._dragged=!0,this._mouseAction("drag",a));return!1};O.prototype._mouseOver=function(a){this._mouseAction("over",a);return!1};O.prototype._mouseOut=function(a){this._mouseAction("out",a);this._dragged&&this._mouseAction("drop",
a);return this._dragged=!1};O.prototype._mouseClick=function(a){this._mouseAction("click",a);return this._dragged=this._pressed=!1};O.prototype._contextMenu=function(a){this._mouseAction("contextmenu",a);return!1};O.prototype._touchMove=function(a){this._mouseMove(a);a.preventDefault();return!1};O.prototype._touchStart=function(a){this._mouseDown(a);a.preventDefault();return!1};$jscomp.global.Object.defineProperties(O.prototype,{pointer:{configurable:!0,enumerable:!0,get:function(){var a=this._pointer.clone();
a.id=this._pointer.id;return a}}});var ha=function(){this._ready=!1};$jscomp.global.Object.defineProperties(ha.prototype,{ready:{configurable:!0,enumerable:!0,get:function(){return this._ready}}});var Q=function(){var a=ha.apply(this,arguments)||this;a._filled=!0;a._stroked=!0;a._font=new ca(14,"sans-serif");return a};$jscomp.inherits(Q,ha);Q.prototype._multiple=function(a,b,c){for(var d=[],e=2;e<arguments.length;++e)d[e-2]=arguments[e];if(!a)return this;e=0;for(var f=a.length;e<f;e++)this[b].apply(this,
[a[e]].concat($jscomp.arrayFromIterable(d)));return this};Q.prototype.alpha=function(a){return this};Q.prototype.fill=function(a){return this};Q.prototype.fillOnly=function(a){this.stroke(!1);return this.fill(a)};Q.prototype.stroke=function(a,b,c,d){return this};Q.prototype.strokeOnly=function(a,b,c,d){this.fill(!1);return this.stroke(a,b,c,d)};Q.prototype.points=function(a,b,c){if(a){for(var d=0,e=a.length;d<e;d++)this.point(a[d],b,c);return this}};Q.prototype.circles=function(a){return this._multiple(a,
"circle")};Q.prototype.squares=function(a){return this._multiple(a,"square")};Q.prototype.lines=function(a){return this._multiple(a,"line")};Q.prototype.polygons=function(a){return this._multiple(a,"polygon")};Q.prototype.rects=function(a){return this._multiple(a,"rect")};$jscomp.global.Object.defineProperties(Q.prototype,{filled:{configurable:!0,enumerable:!0,get:function(){return this._filled},set:function(a){this._filled=a}},stroked:{configurable:!0,enumerable:!0,get:function(){return this._stroked},
set:function(a){this._stroked=a}},currentFont:{configurable:!0,enumerable:!0,get:function(){return this._font}}});var ca=function(a,b,c,d,e){this.size=void 0===a?12:a;this.face=void 0===b?"sans-serif":b;this.style=void 0===d?"":d;this.weight=void 0===c?"":c;this.lineHeight=void 0===e?1.5:e};ca.prototype.toString=function(){return this.value};$jscomp.global.Object.defineProperties(ca.prototype,{value:{configurable:!0,enumerable:!0,get:function(){return this.style+" "+this.weight+" "+this.size+"px/"+
this.lineHeight+" "+this.face}}});var da=function(){};da.textWidthEstimator=function(a,b,c){b=void 0===b?["M","n","."]:b;c=void 0===c?[.06,.8,.14]:c;a=b.map(a);var d=(new k(c)).dot(a);return function(e){return e.length*d}};da.truncate=function(a,b,c,d){d=void 0===d?"":d;a=Math.floor(b.length*Math.min(1,c/a(b)));return a<b.length?(a=Math.max(0,a-d.length),[b.substr(0,a)+d,a]):[b,b.length]};da.fontSizeToBox=function(a,b,c){b=void 0===b?1:b;c=void 0===c?!0:c;a=N.fromGroup(a);var d=c?a.height:a.width,
e=b*d;return function(f){f=N.fromGroup(f);return(c?f.height:f.width)/d*e}};da.fontSizeToThreshold=function(a,b){b=void 0===b?0:b;return function(c,d){d=c*d/a;return 0>b?Math.min(d,c):0<b?Math.max(d,c):d}};L=function(a,b){var c=O.call(this)||this;c._pixelScale=1;c._autoResize=!0;c._bgcolor="#e1e9f0";c._offscreen=!1;c._initialResize=!1;c.id="pt";if(a instanceof Element)c.id="pts_existing_space";else{var d="#"===a[0]||"."===a[0]?a:"#"+a;a=document.querySelector(d);c.id=d.substr(1)}a?"canvas"!=a.nodeName.toLowerCase()?
(c._container=a,c._canvas=c._createElement("canvas",c.id+"_canvas"),c._container.appendChild(c._canvas),c._initialResize=!0):(c._canvas=a,c._container=a.parentElement,c._autoResize=!1):(c._container=c._createElement("div",c.id+"_container"),c._canvas=c._createElement("canvas",c.id),c._container.appendChild(c._canvas),document.body.appendChild(c._container));setTimeout(c._ready.bind(c,b),100);c._ctx=c._canvas.getContext("2d");return c};$jscomp.inherits(L,O);L.prototype._createElement=function(a,b){a=
document.createElement(void 0===a?"div":a);a.setAttribute("id",b);return a};L.prototype._ready=function(a){if(!this._container)throw Error("Cannot initiate #"+this.id+" element");this._isReady=!0;this._resizeHandler(null);this.clear(this._bgcolor);this._canvas.dispatchEvent(new Event("ready"));for(var b in this.players)this.players.hasOwnProperty(b)&&this.players[b].start&&this.players[b].start(this.bound.clone(),this);this._pointer=this.center;this._initialResize=!1;a&&a(this.bound,this._canvas)};
L.prototype.setup=function(a){this._bgcolor=a.bgcolor?a.bgcolor:"transparent";this.autoResize=void 0!=a.resize?a.resize:!1;!1!==a.retina&&(this._pixelScale=Math.max(1,(window?window.devicePixelRatio||1:1)/(this._ctx.webkitBackingStorePixelRatio||this._ctx.mozBackingStorePixelRatio||this._ctx.msBackingStorePixelRatio||this._ctx.oBackingStorePixelRatio||this._ctx.backingStorePixelRatio||1)));a.offscreen?(this._offscreen=!0,this._offCanvas=this._createElement("canvas",this.id+"_offscreen"),this._offCtx=
this._offCanvas.getContext("2d")):this._offscreen=!1;return this};L.prototype.resize=function(a,b){this.bound=a;this._canvas.width=this.bound.size.x*this._pixelScale;this._canvas.height=this.bound.size.y*this._pixelScale;this._canvas.style.width=Math.floor(this.bound.size.x)+"px";this._canvas.style.height=Math.floor(this.bound.size.y)+"px";this._offscreen&&(this._offCanvas.width=this.bound.size.x*this._pixelScale,this._offCanvas.height=this.bound.size.y*this._pixelScale);1!=this._pixelScale&&(this._ctx.scale(this._pixelScale,
this._pixelScale),this._offscreen&&this._offCtx.scale(this._pixelScale,this._pixelScale));for(var c in this.players)this.players.hasOwnProperty(c)&&(a=this.players[c],a.resize&&a.resize(this.bound,b));this.render(this._ctx);b&&!this.isPlaying&&this.playOnce(0);return this};L.prototype._resizeHandler=function(a){if(window){var b=this._autoResize||this._initialResize?this._container.getBoundingClientRect():this._canvas.getBoundingClientRect();b&&(b=N.fromBoundingRect(b),b.center=b.center.add(window.pageXOffset,
window.pageYOffset),this.resize(b,a))}};L.prototype.getForm=function(){return new E(this)};L.prototype.clear=function(a){a&&(this._bgcolor=a);a=this._ctx.fillStyle;this._bgcolor&&"transparent"!==this._bgcolor?((0===this._bgcolor.indexOf("rgba")||9===this._bgcolor.length&&0===this._bgcolor.indexOf("#"))&&this._ctx.clearRect(-1,-1,this._canvas.width+1,this._canvas.height+1),this._ctx.fillStyle=this._bgcolor,this._ctx.fillRect(-1,-1,this._canvas.width+1,this._canvas.height+1)):this._ctx.clearRect(-1,
-1,this._canvas.width+1,this._canvas.height+1);this._ctx.fillStyle=a;return this};L.prototype.clearOffscreen=function(a){this._offscreen&&(a?(this._offCtx.fillStyle=a,this._offCtx.fillRect(-1,-1,this._canvas.width+1,this._canvas.height+1)):this._offCtx.clearRect(-1,-1,this._offCanvas.width+1,this._offCanvas.height+1));return this};L.prototype.playItems=function(a){this._isReady&&(this._ctx.save(),this._offscreen&&this._offCtx.save(),O.prototype.playItems.call(this,a),this._ctx.restore(),this._offscreen&&
this._offCtx.restore(),this.render(this._ctx))};L.prototype.dispose=function(){if(window)return window.removeEventListener("resize",this._resizeHandler.bind(this)),this.stop(),this.removeAll(),this};L.prototype.recorder=function(a,b,c){b=void 0===b?"webm":b;c=void 0===c?15E6:c;var d=this._canvas.captureStream();c=new MediaRecorder(d,{mimeType:"video/"+b,bitsPerSecond:c});c.ondataavailable=function(e){e=URL.createObjectURL(new Blob([e.data],{type:"video/"+b}));if("function"===typeof a)a(e);else if(a){var f=
document.createElement("a");f.href=e;f.download="canvas_video."+b;f.click();f.remove()}};return c};$jscomp.global.Object.defineProperties(L.prototype,{autoResize:{configurable:!0,enumerable:!0,set:function(a){window&&((this._autoResize=a)?window.addEventListener("resize",this._resizeHandler.bind(this)):window.removeEventListener("resize",this._resizeHandler.bind(this)))},get:function(){return this._autoResize}},background:{configurable:!0,enumerable:!0,set:function(a){this._bgcolor=a},get:function(){return this._bgcolor}},
pixelScale:{configurable:!0,enumerable:!0,get:function(){return this._pixelScale}},hasOffscreen:{configurable:!0,enumerable:!0,get:function(){return this._offscreen}},offscreenCtx:{configurable:!0,enumerable:!0,get:function(){return this._offCtx}},offscreenCanvas:{configurable:!0,enumerable:!0,get:function(){return this._offCanvas}},element:{configurable:!0,enumerable:!0,get:function(){return this._canvas}},parent:{configurable:!0,enumerable:!0,get:function(){return this._container}},ready:{configurable:!0,
enumerable:!0,get:function(){return this._isReady}},ctx:{configurable:!0,enumerable:!0,get:function(){return this._ctx}}});var E=function(a){var b=Q.call(this)||this;b._style={fillStyle:"#f03",strokeStyle:"#fff",lineWidth:1,lineJoin:"bevel",lineCap:"butt",globalAlpha:1};var c=function(d){b._ctx=d;b._ctx.fillStyle=b._style.fillStyle;b._ctx.strokeStyle=b._style.strokeStyle;b._ctx.lineJoin="bevel";b._ctx.font=b._font.value;b._ready=!0};a instanceof CanvasRenderingContext2D?c(a):(b._space=a,b._space.add({start:function(){c(b._space.ctx)}}));
return b};$jscomp.inherits(E,Q);E.prototype.useOffscreen=function(a,b){a=void 0===a?!0:a;(b=void 0===b?!1:b)&&this._space.clearOffscreen("string"==typeof b?b:null);this._ctx=this._space.hasOffscreen&&a?this._space.offscreenCtx:this._space.ctx;return this};E.prototype.renderOffscreen=function(a){a=void 0===a?[0,0]:a;this._space.hasOffscreen&&this._space.ctx.drawImage(this._space.offscreenCanvas,a[0],a[1],this._space.width,this._space.height)};E.prototype.alpha=function(a){this._ctx.globalAlpha=a;this._style.globalAlpha=
a;return this};E.prototype.fill=function(a){"boolean"==typeof a?this.filled=a:(this.filled=!0,this._style.fillStyle=a,this._ctx.fillStyle=a);return this};E.prototype.stroke=function(a,b,c,d){"boolean"==typeof a?this.stroked=a:(this.stroked=!0,this._style.strokeStyle=a,this._ctx.strokeStyle=a,b&&(this._ctx.lineWidth=b,this._style.lineWidth=b),c&&(this._ctx.lineJoin=c,this._style.lineJoin=c),d&&(this._ctx.lineCap=d,this._style.lineCap=d));return this};E.prototype.gradient=function(a){var b=this,c=[];
2>a.length&&a.push([.99,"#000"],[1,"#000"]);for(var d=0,e=a.length;d<e;d++)c.push(["string"===typeof a[d]?1/(a.length-1)*d:a[d][0],"string"===typeof a[d]?a[d]:a[d][1]]);return function(f,h){f=f.map(function(y){return y.abs()});h&&h.map(function(y){return y.abs()});f=h?b.ctx.createRadialGradient(f[0][0],f[0][1],f[1][0],h[0][0],h[0][1],h[1][0]):b.ctx.createLinearGradient(f[0][0],f[0][1],f[1][0],f[1][1]);h=0;for(var u=c.length;h<u;h++)f.addColorStop(c[h][0],c[h][1]);return f}};E.prototype.composite=
function(a){this.ctx.globalCompositeOperation=void 0===a?"source-over":a;return this};E.prototype.clip=function(){this.ctx.clip();return this};E.prototype.dash=function(a,b){a=void 0===a?!0:a;b=void 0===b?0:b;a?(!0===a&&(a=[5,5]),this._ctx.setLineDash([a[0],a[1]]),this._ctx.lineDashOffset=b):(this._ctx.setLineDash([]),this._ctx.lineDashOffset=0);return this};E.prototype.font=function(a,b,c,d,e){"number"==typeof a?(this._font.size=a,e&&(this._font.face=e),b&&(this._font.weight=b),c&&(this._font.style=
c),d&&(this._font.lineHeight=d)):this._font=a;this._ctx.font=this._font.value;this._estimateTextWidth&&this.fontWidthEstimate(!0);return this};E.prototype.fontWidthEstimate=function(a){var b=this;this._estimateTextWidth=void 0===a||a?da.textWidthEstimator(function(c){return b._ctx.measureText(c).width}):void 0;return this};E.prototype.getTextWidth=function(a){return this._estimateTextWidth?this._estimateTextWidth(a):this._ctx.measureText(a+" .").width};E.prototype._textTruncate=function(a,b,c){c=
void 0===c?"":c;return da.truncate(this.getTextWidth.bind(this),a,b,c)};E.prototype._textAlign=function(a,b,c,d){a=g.iterToArray(a);if(g.arrayCheck(a)){d||(d=p.center(a));var e=a[0][0];if("end"==this._ctx.textAlign||"right"==this._ctx.textAlign)e=a[1][0];else if("center"==this._ctx.textAlign||"middle"==this._ctx.textAlign)e=d[0];d=d[1];if("top"==b||"start"==b)d=a[0][1];else if("end"==b||"bottom"==b)d=a[1][1];return c?new k(e+c[0],d+c[1]):new k(e,d)}};E.prototype.reset=function(){for(var a in this._style)this._style.hasOwnProperty(a)&&
(this._ctx[a]=this._style[a]);this._font=new ca;this._ctx.font=this._font.value;return this};E.prototype._paint=function(){this._filled&&this._ctx.fill();this._stroked&&this._ctx.stroke()};E.point=function(a,b,c,d){d=void 0===d?"square":d;if(b){if(!E[d])throw Error(d+" is not a static function of CanvasForm");E[d](a,b,void 0===c?5:c)}};E.prototype.point=function(a,b,c){E.point(this._ctx,a,void 0===b?5:b,void 0===c?"square":c);this._paint();return this};E.circle=function(a,b,c){c=void 0===c?10:c;b&&
(a.beginPath(),a.arc(b[0],b[1],c,0,6.283185307179586,!1),a.closePath())};E.prototype.circle=function(a){a=g.iterToArray(a);E.circle(this._ctx,a[0],a[1][0]);this._paint();return this};E.ellipse=function(a,b,c,d,e,f,h){d=void 0===d?0:d;e=void 0===e?0:e;f=void 0===f?6.283185307179586:f;h=void 0===h?!1:h;b&&c&&(a.beginPath(),a.ellipse(b[0],b[1],c[0],c[1],d,e,f,h))};E.prototype.ellipse=function(a,b,c,d,e,f){E.ellipse(this._ctx,a,b,void 0===c?0:c,void 0===d?0:d,void 0===e?6.283185307179586:e,void 0===f?
!1:f);this._paint();return this};E.arc=function(a,b,c,d,e,f){b&&(a.beginPath(),a.arc(b[0],b[1],c,d,e,f))};E.prototype.arc=function(a,b,c,d,e){E.arc(this._ctx,a,b,c,d,e);this._paint();return this};E.square=function(a,b,c){if(b){var d=b[0]-c,e=b[1]-c,f=b[0]+c;b=b[1]+c;a.beginPath();a.moveTo(d,e);a.lineTo(d,b);a.lineTo(f,b);a.lineTo(f,e);a.closePath()}};E.prototype.square=function(a,b){E.square(this._ctx,a,b);this._paint();return this};E.line=function(a,b){if(g.arrayCheck(b)){var c=0;a.beginPath();b=
$jscomp.makeIterator(b);for(var d=b.next();!d.done;d=b.next())(d=d.value)&&(0<c++?a.lineTo(d[0],d[1]):a.moveTo(d[0],d[1]))}};E.prototype.line=function(a){E.line(this._ctx,a);this._paint();return this};E.polygon=function(a,b){g.arrayCheck(b)&&(E.line(a,b),a.closePath())};E.prototype.polygon=function(a){E.polygon(this._ctx,a);this._paint();return this};E.rect=function(a,b){b=g.iterToArray(b);g.arrayCheck(b)&&(a.beginPath(),a.moveTo(b[0][0],b[0][1]),a.lineTo(b[0][0],b[1][1]),a.lineTo(b[1][0],b[1][1]),
a.lineTo(b[1][0],b[0][1]),a.closePath())};E.prototype.rect=function(a){E.rect(this._ctx,a);this._paint();return this};E.image=function(a,b,c,d){b=g.iterToArray(b);"number"===typeof b[0]?d=b:d?(d=g.iterToArray(d),d=[d[0][0],d[0][1],d[1][0]-d[0][0],d[1][1]-d[0][1],b[0][0],b[0][1],b[1][0]-b[0][0],b[1][1]-b[0][1]]):d=[b[0][0],b[0][1],b[1][0]-b[0][0],b[1][1]-b[0][1]];a.drawImage.apply(a,[c].concat($jscomp.arrayFromIterable(d)))};E.prototype.image=function(a,b,c){E.image(this._ctx,a,b,c);return this};E.imageData=
function(a,b,c){b=g.iterToArray(b);"number"===typeof b[0]?a.putImageData(c,b[0],b[1]):a.putImageData(c,b[0][0],b[0][1],b[0][0],b[0][1],b[1][0],b[1][1])};E.prototype.imageData=function(a,b){E.imageData(this._ctx,a,b);return this};E.text=function(a,b,c,d){b&&a.fillText(c,b[0],b[1],d)};E.prototype.text=function(a,b,c){E.text(this._ctx,a,b,c);return this};E.prototype.textBox=function(a,b,c,d,e){c=void 0===c?"middle":c;d=void 0===d?"":d;if(void 0===e||e)this._ctx.textBaseline=c;e=p.size(a);b=this._textTruncate(b,
e[0],d);this.text(this._textAlign(a,c),b[0]);return this};E.prototype.paragraphBox=function(a,b,c,d,e){var f=this;c=void 0===c?1.2:c;d=void 0===d?"top":d;e=void 0===e?!0:e;a=g.iterToArray(a);var h=p.size(a);this._ctx.textBaseline="top";var u=this._font.size*c,y=function(J,P,T){P=void 0===P?[]:P;T=void 0===T?0:T;if(!J||e&&T*u>h[1]-2*u)return P;if(1E4<T)throw Error("max recursion reached (10000)");var S=f._textTruncate(J,h[0],""),X=S[0].indexOf("\n");if(0<=X)return P.push(S[0].substr(0,X)),y(J.substr(X+
1),P,T+1);X=S[0].lastIndexOf(" ")+1;if(0>=X||S[1]===J.length)X=void 0;var aa=S[0].substr(0,X);P.push(aa);return 0>=S[1]||S[1]===J.length?P:y(J.substr(X||S[1]),P,T+1)};b=y(b);var G=b.length*u;c=a;"middle"==d||"center"==d?(d=(h[1]-G)/2,e&&(d=Math.max(0,d)),c=new n(a[0].$add(0,d),a[1].$subtract(0,d))):c="bottom"==d?new n(a[0].$add(0,h[1]-G),a[1]):new n(a[0],a[0].$add(h[0],G));d=p.center(c);a=0;for(G=b.length;a<G;a++)this.text(this._textAlign(c,"top",[0,a*u],d),b[a]);return this};E.prototype.alignText=
function(a,b){b=void 0===b?"alphabetic":b;"center"==b&&(b="middle");"baseline"==b&&(b="alphabetic");this._ctx.textAlign=void 0===a?"left":a;this._ctx.textBaseline=b;return this};E.prototype.log=function(a){var b=this._ctx.measureText(a).width+20;this.stroke(!1).fill("rgba(0,0,0,.4)").rect([[0,0],[b,20]]);this.fill("#fff").text([10,14],a);return this};$jscomp.global.Object.defineProperties(E.prototype,{space:{configurable:!0,enumerable:!0,get:function(){return this._space}},ctx:{configurable:!0,enumerable:!0,
get:function(){return this._space.ctx}}});var ea=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];b=null.apply(this,[].concat($jscomp.arrayFromIterable(b)))||this;b.perm=[];b._n=new Pt(.01,.01);b.perm=null.concat(null);return b};$jscomp.inherits(ea,null);ea.prototype.initNoise=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];this._n=new (Function.prototype.bind.apply(Pt,[null].concat($jscomp.arrayFromIterable(b))));return this};ea.prototype.step=function(a,
b){this._n.add(void 0===a?0:a,void 0===b?0:b);return this};ea.prototype.seed=function(a){0<a&&1>a&&(a*=65536);a=Math.floor(a);256>a&&(a|=a<<8);for(var b=0;255>b;b++)this.perm[b]=this.perm[b+256]=b&1?null[b]^a&255:null[b]^a>>8&255;return this};ea.prototype.noise2D=function(){var a=Math.max(0,Math.floor(this._n[0]))%255,b=Math.max(0,Math.floor(this._n[1]))%255,c=this._n[0]%255-a,d=this._n[1]%255-b,e=Vec.dot(null[(a+this.perm[b])%12],[c,d,0]),f=Vec.dot(null[(a+this.perm[b+1])%12],[c,d-1,0]),h=Vec.dot(null[(a+
1+this.perm[b])%12],[c-1,d,0]);a=Vec.dot(null[(a+1+this.perm[b+1])%12],[c-1,d-1,0]);c=c*c*c*(c*(6*c-15)+10);return Num.lerp(Num.lerp(e,h,c),Num.lerp(f,a,c),d*d*d*(d*(6*d-15)+10))};var Z=function(){var a=null.apply(this,arguments)||this;a._mesh=[];return a};$jscomp.inherits(Z,null);Z.prototype.delaunay=function(a){var b=this;a=void 0===a?!0:a;if(3>this.length)return[];this._mesh=[];for(var c=this.length,d=[],e=0;e<c;e++)d[e]=e;d.sort(function(ja,ka){return b[ka][0]-b[ja][0]});var f=this.slice();e=
this._superTriangle();f=f.concat(e);e=[this._circum(c,c+1,c+2,e)];for(var h=[],u=[],y=0,G=d.length;y<G;y++){var J=d[y],P=[],T=e.length;for(this._mesh[J]||(this._mesh[J]={});T--;){var S=e[T],X=S.circle[1][0],aa=f[J].$subtract(S.circle[0]);0<aa[0]&&aa[0]*aa[0]>X*X?(h.push(S),u.push(S.triangle),e.splice(T,1)):aa[0]*aa[0]+aa[1]*aa[1]-X*X>Const.epsilon||(P.push(S.i,S.j,S.j,S.k,S.k,S.i),e.splice(T,1))}Z._dedupe(P);for(T=P.length;1<T;)e.push(this._circum(P[--T],P[--T],J,!1,f))}d=0;for(f=e.length;d<f;d++)y=
e[d],y.i<c&&y.j<c&&y.k<c&&(h.push(y),u.push(y.triangle),this._cache(y));return a?u:h};Z.prototype.voronoi=function(){for(var a=[],b=0,c=this._mesh.length;b<c;b++)a.push(this.neighborPts(b,!0));return a};Z.prototype.mesh=function(){return this._mesh};Z.prototype.neighborPts=function(a,b){b=void 0===b?!1:b;var c=new Group,d=this._mesh,e;for(e in d[a])d[a].hasOwnProperty(e)&&c.push(d[a][e].circle[0]);return b?Geom.sortEdges(c):c};Z.prototype.neighbors=function(a){var b=[],c=this._mesh,d;for(d in c[a])c[a].hasOwnProperty(d)&&
b.push(c[a][d]);return b};Z.prototype._cache=function(a){this._mesh[a.i][Math.min(a.j,a.k)+"-"+Math.max(a.j,a.k)]=a;this._mesh[a.j][Math.min(a.i,a.k)+"-"+Math.max(a.i,a.k)]=a;this._mesh[a.k][Math.min(a.i,a.j)+"-"+Math.max(a.i,a.j)]=a};Z.prototype._superTriangle=function(){for(var a=this[0],b=this[0],c=1,d=this.length;c<d;c++)a=a.$min(this[c]),b=b.$max(this[c]);c=b.$subtract(a);a=a.$add(b).divide(2);b=Math.max(c[0],c[1]);return new Group(a.$subtract(20*b,b),a.$add(0,20*b),a.$add(20*b,-b))};Z.prototype._triangle=
function(a,b,c,d){d=void 0===d?this:d;return new Group(d[a],d[b],d[c])};Z.prototype._circum=function(a,b,c,d,e){d=d||this._triangle(a,b,c,void 0===e?this:e);return{i:a,j:b,k:c,triangle:d,circle:Triangle.circumcircle(d)}};Z._dedupe=function(a){for(var b=a.length;1<b;)for(var c=a[--b],d=a[--b],e=b;1<e;){var f=a[--e],h=a[--e];if(d==h&&c==f||d==f&&c==h){a.splice(b,2);a.splice(e,2);break}}return a};var w=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];b=k.apply(this,[].concat($jscomp.arrayFromIterable(b)))||
this;b._mode="rgb";b._isNorm=!1;return b};$jscomp.inherits(w,k);w.from=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];c=[1,1,1,1];b=g.getArgs(b);for(var d=0,e=c.length;d<e;d++)d<b.length&&(c[d]=b[d]);return new w(c)};w.fromHex=function(a){"#"==a[0]&&(a=a.substr(1));3>=a.length&&(a=""+(a[0]||"F")+(a[0]||"F")+(a[1]||"F")+(a[1]||"F")+(a[2]||"F")+(a[2]||"F"));var b=1;8===a.length&&(b=a.substr(6)&&1,a=a.substring(0,6));a=parseInt(a,16);return new w(a>>16,a>>8&255,a&255,b)};w.rgb=
function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return w.from.apply(w,$jscomp.arrayFromIterable(b)).toMode("rgb")};w.hsl=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return w.from.apply(w,$jscomp.arrayFromIterable(b)).toMode("hsl")};w.hsb=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return w.from.apply(w,$jscomp.arrayFromIterable(b)).toMode("hsb")};w.lab=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];
return w.from.apply(w,$jscomp.arrayFromIterable(b)).toMode("lab")};w.lch=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return w.from.apply(w,$jscomp.arrayFromIterable(b)).toMode("lch")};w.luv=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return w.from.apply(w,$jscomp.arrayFromIterable(b)).toMode("luv")};w.xyz=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return w.from.apply(w,$jscomp.arrayFromIterable(b)).toMode("xyz")};
w.maxValues=function(a){return w.ranges[a].zipSlice(1).$take([0,1,2])};w.prototype.clone=function(){var a=new w(this);a.toMode(this._mode);return a};w.prototype.toMode=function(a,b){if(void 0===b?0:b)if(b=this._mode.toUpperCase()+"to"+a.toUpperCase(),w[b])this.to(w[b](this,this._isNorm,this._isNorm));else throw Error("Cannot convert color with "+b);this._mode=a;return this};w.prototype.normalize=function(a){a=void 0===a?!0:a;if(this._isNorm==a)return this;for(var b=w.ranges[this._mode],c=0;3>c;c++)this[c]=
a?D.mapToRange(this[c],b[c][0],b[c][1],0,1):D.mapToRange(this[c],0,1,b[c][0],b[c][1]);this._isNorm=a;return this};w.prototype.$normalize=function(a){a=void 0===a?!0:a;return this.clone().normalize(a)};w.prototype.toString=function(a){a=void 0===a?"mode":a;return"hex"==a?(a=function(b){b=Math.floor(b).toString(16);return 2>b.length?"0"+b:b},"#"+a(this[0])+a(this[1])+a(this[2])):"rgba"==a?"rgba("+Math.floor(this[0])+","+Math.floor(this[1])+","+Math.floor(this[2])+","+this.alpha+")":"rgb"==a?"rgb("+
Math.floor(this[0])+","+Math.floor(this[1])+","+Math.floor(this[2])+")":this._mode+"("+this[0]+","+this[1]+","+this[2]+","+this.alpha+")"};w.RGBtoHSL=function(a,b,c){c=void 0===c?!1:c;var d=$jscomp.makeIterator((void 0===b?0:b)?a:a.$normalize());b=d.next().value;var e=d.next().value;d=d.next().value;var f=Math.max(b,e,d),h=Math.min(b,e,d),u=(f+h)/2;if(f==h)var y=h=0;else{var G=f-h;y=.5<u?G/(2-f-h):G/(f+h);h=0;f===b?h=(e-d)/G+(e<d?6:0):f===e?h=(d-b)/G+2:f===d&&(h=(b-e)/G+4)}return w.hsl(c?h/60:60*
h,y,u,a.alpha)};w.HSLtoRGB=function(a,b,c){b=void 0===b?!1:b;c=void 0===c?!1:c;var d=$jscomp.makeIterator(a),e=d.next().value,f=d.next().value;d=d.next().value;b||(e/=360);if(0==f)return w.rgb(255*d,255*d,255*d,a.alpha);var h=.5>=d?d*(1+f):d+f-d*f,u=2*d-h;b=function(y){y=0>y?y+1:1<y?y-1:y;return 1>6*y?u+(h-u)*y*6:1>2*y?h:2>3*y?u+(h-u)*(2/3-y)*6:u};c=c?1:255;return w.rgb(c*b(e+1/3),c*b(e),c*b(e-1/3),a.alpha)};w.RGBtoHSB=function(a,b,c){c=void 0===c?!1:c;var d=$jscomp.makeIterator((void 0===b?0:b)?
a:a.$normalize());b=d.next().value;var e=d.next().value;d=d.next().value;var f=Math.max(b,e,d),h=Math.min(b,e,d),u=f-h,y=0;f!=h&&(f===b?y=(e-d)/u+(e<d?6:0):f===e?y=(d-b)/u+2:f===d&&(y=(b-e)/u+4));return w.hsb(c?y/60:60*y,0===f?0:u/f,f,a.alpha)};w.HSBtoRGB=function(a,b,c){b=void 0===b?!1:b;c=void 0===c?!1:c;var d=$jscomp.makeIterator(a),e=d.next().value,f=d.next().value;d=d.next().value;b||(e/=360);b=Math.floor(6*e);var h=6*e-b;e=d*(1-f);var u=d*(1-h*f);f=d*(1-(1-h)*f);f=[[d,f,e],[u,d,e],[e,d,f],[e,
u,d],[f,e,d],[d,e,u]][b%6];c=c?1:255;return w.rgb(c*f[0],c*f[1],c*f[2],a.alpha)};w.RGBtoLAB=function(a,b,c){c=void 0===c?!1:c;a=(void 0===b?0:b)?a.$normalize(!1):a;return w.XYZtoLAB(w.RGBtoXYZ(a),!1,c)};w.LABtoRGB=function(a,b,c){c=void 0===c?!1:c;a=(void 0===b?0:b)?a.$normalize(!1):a;return w.XYZtoRGB(w.LABtoXYZ(a),!1,c)};w.RGBtoLCH=function(a,b,c){c=void 0===c?!1:c;a=(void 0===b?0:b)?a.$normalize(!1):a;return w.LABtoLCH(w.RGBtoLAB(a),!1,c)};w.LCHtoRGB=function(a,b,c){c=void 0===c?!1:c;a=(void 0===
b?0:b)?a.$normalize(!1):a;return w.LABtoRGB(w.LCHtoLAB(a),!1,c)};w.RGBtoLUV=function(a,b,c){c=void 0===c?!1:c;a=(void 0===b?0:b)?a.$normalize(!1):a;return w.XYZtoLUV(w.RGBtoXYZ(a),!1,c)};w.LUVtoRGB=function(a,b,c){c=void 0===c?!1:c;a=(void 0===b?0:b)?a.$normalize(!1):a;return w.XYZtoRGB(w.LUVtoXYZ(a),!1,c)};w.RGBtoXYZ=function(a,b,c){c=void 0===c?!1:c;b=(void 0===b?0:b)?a.clone():a.$normalize();for(var d=0;3>d;d++)b[d]=.04045<b[d]?Math.pow((b[d]+.055)/1.055,2.4):b[d]/12.92,c||(b[d]*=100);a=w.xyz(.4124564*
b[0]+.3575761*b[1]+.1804375*b[2],.2126729*b[0]+.7151522*b[1]+.072175*b[2],.0193339*b[0]+.119192*b[1]+.9503041*b[2],a.alpha);return c?a.normalize():a};w.XYZtoRGB=function(a,b,c){c=void 0===c?!1:c;var d=$jscomp.makeIterator((void 0===b?0:b)?a:a.$normalize());b=d.next().value;var e=d.next().value;d=d.next().value;b=[3.2404542*b+-1.5371385*e+-.4985314*d,-.969266*b+1.8760108*e+.041556*d,.0556434*b+-.2040259*e+1.0572252*d];for(e=0;3>e;e++)b[e]=0>b[e]?0:.0031308<b[e]?1.055*Math.pow(b[e],1/2.4)-.055:12.92*
b[e],b[e]=Math.max(0,Math.min(1,b[e])),c||(b[e]=Math.round(255*b[e]));a=w.rgb(b[0],b[1],b[2],a.alpha);return c?a.normalize():a};w.XYZtoLAB=function(a,b,c){c=void 0===c?!1:c;b=(void 0===b?0:b)?a.$normalize(!1):a.clone();b.divide(w.D65);var d=function(f){return.008856<f?Math.pow(f,1/3):7.787*f+16/116},e=d(b[1]);a=w.lab(116*e-16,500*(d(b[0])-e),200*(e-d(b[2])),a.alpha);return c?a.normalize():a};w.LABtoXYZ=function(a,b,c){c=void 0===c?!1:c;b=(void 0===b?0:b)?a.$normalize(!1):a;var d=(b[0]+16)/116,e=d-
b[2]/200,f=function(u){var y=u*u*u;return.008856<y?y:(u-16/116)/7.787},h=w.D65;a=w.xyz(Math.max(0,h[0]*f(b[1]/500+d)),Math.max(0,h[1]*f(d)),Math.max(0,h[2]*f(e)),a.alpha);return c?a.normalize():a};w.XYZtoLUV=function(a,b,c){c=$jscomp.makeIterator((void 0===b?0:b)?a.$normalize(!1):a);var d=c.next().value;b=c.next().value;var e=c.next().value;c=4*d/(d+15*b+3*e);d=9*b/(d+15*b+3*e);b/=100;b=.008856<b?Math.pow(b,1/3):7.787*b+16/116;b=116*b-16;return w.luv(b,13*b*(c-4*w.D65[0]/(w.D65[0]+15*w.D65[1]+3*w.D65[2])),
13*b*(d-9*w.D65[1]/(w.D65[0]+15*w.D65[1]+3*w.D65[2])),a.alpha)};w.LUVtoXYZ=function(a,b,c){var d=$jscomp.makeIterator((void 0===b?0:b)?a.$normalize(!1):a);b=d.next().value;c=d.next().value;d=d.next().value;var e=(b+16)/116,f=e*e*e,h=9*w.D65[1]/(w.D65[0]+15*w.D65[1]+3*w.D65[2]);c=c/(13*b)+4*w.D65[0]/(w.D65[0]+15*w.D65[1]+3*w.D65[2]);d=d/(13*b)+h;e=100*(.008856<f?f:(e-16/116)/7.787);b=-9*e*c/((c-4)*d-c*d);return w.xyz(b,e,(9*e-15*d*e-d*b)/(3*d),a.alpha)};w.LABtoLCH=function(a,b,c){b=(void 0===b?0:b)?
a.$normalize(!1):a;c=z.toDegree(z.boundRadian(Math.atan2(b[2],b[1])));return w.lch(b[0],Math.sqrt(b[1]*b[1]+b[2]*b[2]),c,a.alpha)};w.LCHtoLAB=function(a,b,c){b=(void 0===b?0:b)?a.$normalize(!1):a;c=z.toRadian(b[2]);return w.lab(b[0],Math.cos(c)*b[1],Math.sin(c)*b[1],a.alpha)};$jscomp.global.Object.defineProperties(w.prototype,{hex:{configurable:!0,enumerable:!0,get:function(){return this.toString("hex")}},rgb:{configurable:!0,enumerable:!0,get:function(){return this.toString("rgb")}},rgba:{configurable:!0,
enumerable:!0,get:function(){return this.toString("rgba")}},mode:{configurable:!0,enumerable:!0,get:function(){return this._mode}},r:{configurable:!0,enumerable:!0,get:function(){return this[0]},set:function(a){this[0]=a}},g:{configurable:!0,enumerable:!0,get:function(){return this[1]},set:function(a){this[1]=a}},b:{configurable:!0,enumerable:!0,get:function(){return this[2]},set:function(a){this[2]=a}},h:{configurable:!0,enumerable:!0,get:function(){return"lch"==this._mode?this[2]:this[0]},set:function(a){this["lch"==
this._mode?2:0]=a}},s:{configurable:!0,enumerable:!0,get:function(){return this[1]},set:function(a){this[1]=a}},l:{configurable:!0,enumerable:!0,get:function(){return"hsl"==this._mode?this[2]:this[0]},set:function(a){this["hsl"==this._mode?2:0]=a}},a:{configurable:!0,enumerable:!0,get:function(){return this[1]},set:function(a){this[1]=a}},c:{configurable:!0,enumerable:!0,get:function(){return this[1]},set:function(a){this[1]=a}},u:{configurable:!0,enumerable:!0,get:function(){return this[1]},set:function(a){this[1]=
a}},v:{configurable:!0,enumerable:!0,get:function(){return this[2]},set:function(a){this[2]=a}},alpha:{configurable:!0,enumerable:!0,set:function(a){3<this.length&&(this[3]=a)},get:function(){return 3<this.length?this[3]:1}},normalized:{configurable:!0,enumerable:!0,get:function(){return this._isNorm},set:function(a){this._isNorm=a}}});w.D65=new k(95.047,100,108.883,1);w.ranges={rgb:new n(new k(0,255),new k(0,255),new k(0,255)),hsl:new n(new k(0,360),new k(0,1),new k(0,1)),hsb:new n(new k(0,360),
new k(0,1),new k(0,1)),lab:new n(new k(0,100),new k(-128,127),new k(-128,127)),lch:new n(new k(0,100),new k(0,100),new k(0,360)),luv:new n(new k(0,100),new k(-134,220),new k(-140,122)),xyz:new n(new k(0,100),new k(0,100),new k(0,100))};var I=function(a,b){var c=O.call(this)||this;c.id="domspace";c._autoResize=!0;c._bgcolor="#e1e9f0";c._css={};c.id="pts";if(a instanceof Element){var d=a;c.id="pts_existing_space"}else d=document.querySelector(a),c.id=a.substr(1);d?(c._canvas=d,c._container=d.parentElement):
(c._container=I.createElement("div","pts_container"),c._canvas=I.createElement("div","pts_element"),c._container.appendChild(c._canvas),document.body.appendChild(c._container));setTimeout(c._ready.bind(c,b),50);return c};$jscomp.inherits(I,O);I.createElement=function(a,b,c){a=document.createElement(void 0===a?"div":a);b&&a.setAttribute("id",b);c&&c.appendChild&&c.appendChild(a);return a};I.prototype._ready=function(a){if(!this._container)throw Error("Cannot initiate #"+this.id+" element");this._isReady=
!0;this._resizeHandler(null);this.clear(this._bgcolor);this._canvas.dispatchEvent(new Event("ready"));for(var b in this.players)this.players.hasOwnProperty(b)&&this.players[b].start&&this.players[b].start(this.bound.clone(),this);this._pointer=this.center;this.refresh(!1);a&&a(this.bound,this._canvas)};I.prototype.setup=function(a){a.bgcolor&&(this._bgcolor=a.bgcolor);this.autoResize=void 0!=a.resize?a.resize:!1;return this};I.prototype.getForm=function(){return null};I.prototype.resize=function(a,
b){this.bound=a;this.styles({width:a.width+"px",height:a.height+"px"},!0);for(var c in this.players)this.players.hasOwnProperty(c)&&(a=this.players[c],a.resize&&a.resize(this.bound,b));return this};I.prototype._resizeHandler=function(a){var b=N.fromBoundingRect(this._container.getBoundingClientRect());this._autoResize?this.styles({width:"100%",height:"100%"},!0):this.styles({width:b.width+"px",height:b.height+"px"},!0);this.resize(b,a)};I.prototype.clear=function(a){a&&(this.background=a);this._canvas.innerHTML=
"";return this};I.prototype.style=function(a,b,c){this._css[a]=b;(void 0===c?0:c)&&(this._canvas.style[a]=b);return this};I.prototype.styles=function(a,b){b=void 0===b?!1:b;for(var c in a)a.hasOwnProperty(c)&&this.style(c,a[c],b);return this};I.setAttr=function(a,b){for(var c in b)b.hasOwnProperty(c)&&a.setAttribute(c,b[c]);return a};I.getInlineStyles=function(a){var b="",c;for(c in a)a.hasOwnProperty(c)&&a[c]&&(b+=c+": "+a[c]+"; ");return b};I.prototype.dispose=function(){window.removeEventListener("resize",
this._resizeHandler.bind(this));this.stop();this.removeAll();return this};$jscomp.global.Object.defineProperties(I.prototype,{autoResize:{configurable:!0,enumerable:!0,set:function(a){(this._autoResize=a)?window.addEventListener("resize",this._resizeHandler.bind(this)):(delete this._css.width,delete this._css.height,window.removeEventListener("resize",this._resizeHandler.bind(this)))},get:function(){return this._autoResize}},element:{configurable:!0,enumerable:!0,get:function(){return this._canvas}},
parent:{configurable:!0,enumerable:!0,get:function(){return this._container}},ready:{configurable:!0,enumerable:!0,get:function(){return this._isReady}},background:{configurable:!0,enumerable:!0,set:function(a){this._bgcolor=a;this._container.style.backgroundColor=this._bgcolor},get:function(){return this._bgcolor}}});var W=function(){return I.apply(this,arguments)||this};$jscomp.inherits(W,I);W.prototype.getForm=function(){return new F(this)};W.htmlElement=function(a,b,c,d){d=void 0===d?!0:d;if(!a||
!a.appendChild)throw Error("parent is not a valid DOM element");var e=document.querySelector("#"+c);e||(e=document.createElement(b),e.setAttribute("id",c),d&&e.setAttribute("class",c.substring(0,c.indexOf("-"))),a.appendChild(e));return e};W.prototype.remove=function(a){this._container.querySelectorAll("."+F.scopeID(a)).forEach(function(b){b.parentNode.removeChild(b)});return I.prototype.remove.call(this,a)};W.prototype.removeAll=function(){this._container.innerHTML="";return I.prototype.removeAll.call(this)};
var F=function(a){var b=Q.call(this)||this;b._style={filled:!0,stroked:!0,background:"#f03","border-color":"#fff",color:"#000","border-width":"1px","border-radius":"0","border-style":"solid",opacity:1,position:"absolute",top:0,left:0,width:0,height:0};b._ctx={group:null,groupID:"pts",groupCount:0,currentID:"pts0",currentClass:"",style:{}};b._ready=!1;b._space=a;b._space.add({start:function(){b._ctx.group=b._space.element;b._ctx.groupID="pts_dom_"+F.groupID++;b._ctx.style=Object.assign({},b._style);
b._ready=!0}});return b};$jscomp.inherits(F,Q);F.prototype.styleTo=function(a,b,c){if(void 0===this._ctx.style[a])throw Error(a+" style property doesn't exist");this._ctx.style[a]=""+b+(void 0===c?"":c)};F.prototype.alpha=function(a){this.styleTo("opacity",a);return this};F.prototype.fill=function(a){"boolean"==typeof a?(this.styleTo("filled",a),a||this.styleTo("background","transparent")):(this.styleTo("filled",!0),this.styleTo("background",a));return this};F.prototype.stroke=function(a,b,c,d){"boolean"==
typeof a?(this.styleTo("stroked",a),a||this.styleTo("border-width",0)):(this.styleTo("stroked",!0),this.styleTo("border-color",a),this.styleTo("border-width",(b||1)+"px"));return this};F.prototype.fillText=function(a){this.styleTo("color",a);return this};F.prototype.cls=function(a){this._ctx.currentClass="boolean"==typeof a?"":a;return this};F.prototype.font=function(a,b,c,d,e){"number"==typeof a?(this._font.size=a,e&&(this._font.face=e),b&&(this._font.weight=b),c&&(this._font.style=c),d&&(this._font.lineHeight=
d)):this._font=a;this._ctx.style.font=this._font.value;return this};F.prototype.reset=function(){this._ctx.style=Object.assign({},this._style);this._font=new ca(10,"sans-serif");this._ctx.style.font=this._font.value;return this};F.prototype.updateScope=function(a,b){this._ctx.group=b;this._ctx.groupID=a;this._ctx.groupCount=0;this.nextID();return this._ctx};F.prototype.scope=function(a){if(!a||null==a.animateID)throw Error("item not defined or not yet added to Space");return this.updateScope(F.scopeID(a),
this.space.element)};F.prototype.nextID=function(){this._ctx.groupCount++;this._ctx.currentID=this._ctx.groupID+"-"+this._ctx.groupCount;return this._ctx.currentID};F.getID=function(a){return a.currentID||"p-"+F.domID++};F.scopeID=function(a){return"item-"+a.animateID};F.style=function(a,b){var c=[];b.filled||c.push("background: none");b.stroked||c.push("border: none");for(var d in b)if(b.hasOwnProperty(d)&&"filled"!=d&&"stroked"!=d){var e=b[d];e&&(b.filled||0!==d.indexOf("background"))&&(b.stroked||
0!==d.indexOf("border-width"))&&c.push(d+": "+e)}return W.setAttr(a,{style:c.join(";")})};F.rectStyle=function(a,b,c){a.style.left=b[0]+"px";a.style.top=b[1]+"px";a.style.width=c[0]+"px";a.style.height=c[1]+"px";return a};F.textStyle=function(a,b){a.style.left=b[0]+"px";a.style.top=b[1]+"px";return a};F.point=function(a,b,c,d){c=void 0===c?5:c;return"circle"===(void 0===d?"square":d)?F.circle(a,b,c):F.square(a,b,c)};F.prototype.point=function(a,b,c){b=void 0===b?5:b;c=void 0===c?"square":c;this.nextID();
"circle"==c&&this.styleTo("border-radius","100%");F.point(this._ctx,a,b,c);return this};F.circle=function(a,b,c){c=void 0===c?10:c;var d=W.htmlElement(a.group,"div",F.getID(a));W.setAttr(d,{class:"pts-form pts-circle "+a.currentClass});F.rectStyle(a,(new k(b)).$subtract(c),new k(2*c,2*c));F.style(d,a.style);return d};F.prototype.circle=function(a){this.nextID();this.styleTo("border-radius","100%");F.circle(this._ctx,a[0],a[1][0]);return this};F.square=function(a,b,c){var d=W.htmlElement(a.group,"div",
F.getID(a));W.setAttr(d,{class:"pts-form pts-square "+a.currentClass});F.rectStyle(a,(new k(b)).$subtract(c),new k(2*c,2*c));F.style(d,a.style);return d};F.prototype.square=function(a,b){this.nextID();F.square(this._ctx,a,b);return this};F.rect=function(a,b){b=g.iterToArray(b);if(g.arrayCheck(b)){var c=W.htmlElement(a.group,"div",F.getID(a));W.setAttr(c,{class:"pts-form pts-rect "+a.currentClass});F.rectStyle(a,b[0],b[1]);F.style(c,a.style);return c}};F.prototype.rect=function(a){this.nextID();this.styleTo("border-radius",
"0");F.rect(this._ctx,a);return this};F.text=function(a,b,c){var d=W.htmlElement(a.group,"div",F.getID(a));W.setAttr(d,{class:"pts-form pts-text "+a.currentClass});d.textContent=c;F.textStyle(a,b);F.style(d,a.style);return d};F.prototype.text=function(a,b){this.nextID();F.text(this._ctx,a,b);return this};F.prototype.log=function(a){this.fill("#000").stroke("#fff",.5).text([10,14],a);return this};F.prototype.arc=function(a,b,c,d,e){g.warn("arc is not implemented in HTMLForm");return this};F.prototype.line=
function(a){g.warn("line is not implemented in HTMLForm");return this};F.prototype.polygon=function(a){g.warn("polygon is not implemented in HTMLForm");return this};$jscomp.global.Object.defineProperties(F.prototype,{space:{configurable:!0,enumerable:!0,get:function(){return this._space}}});F.groupID=0;F.domID=0;var U=function(a,b){a=I.call(this,a,b)||this;a._bgcolor="#999";"svg"!=a._canvas.nodeName.toLowerCase()&&(b=U.svgElement(a._canvas,"svg",a.id+"_svg"),a._container=a._canvas,a._canvas=b);return a};
$jscomp.inherits(U,I);U.prototype.getForm=function(){return new C(this)};U.prototype.resize=function(a,b){I.prototype.resize.call(this,a,b);U.setAttr(this.element,{viewBox:"0 0 "+this.bound.width+" "+this.bound.height,width:""+this.bound.width,height:""+this.bound.height,xmlns:"http://www.w3.org/2000/svg",version:"1.1"});return this};U.svgElement=function(a,b,c){if(!a||!a.appendChild)throw Error("parent is not a valid DOM element");var d=document.querySelector("#"+c);d||(d=document.createElementNS("http://www.w3.org/2000/svg",
b),d.setAttribute("id",c),a.appendChild(d));return d};U.prototype.remove=function(a){this._container.querySelectorAll("."+C.scopeID(a)).forEach(function(b){b.parentNode.removeChild(b)});return I.prototype.remove.call(this,a)};U.prototype.removeAll=function(){this._container.innerHTML="";return I.prototype.removeAll.call(this)};$jscomp.global.Object.defineProperties(U.prototype,{element:{configurable:!0,enumerable:!0,get:function(){return this._canvas}}});var C=function(a){var b=Q.call(this)||this;
b._style={filled:!0,stroked:!0,fill:"#f03",stroke:"#fff","stroke-width":1,"stroke-linejoin":"bevel","stroke-linecap":"sqaure",opacity:1};b._ctx={group:null,groupID:"pts",groupCount:0,currentID:"pts0",currentClass:"",style:{}};b._ready=!1;b._space=a;b._space.add({start:function(){b._ctx.group=b._space.element;b._ctx.groupID="pts_svg_"+C.groupID++;b._ctx.style=Object.assign({},b._style);b._ready=!0}});return b};$jscomp.inherits(C,Q);C.prototype.styleTo=function(a,b){if(void 0===this._ctx.style[a])throw Error(a+
" style property doesn't exist");this._ctx.style[a]=b};C.prototype.alpha=function(a){this.styleTo("opacity",a);return this};C.prototype.fill=function(a){"boolean"==typeof a?this.styleTo("filled",a):(this.styleTo("filled",!0),this.styleTo("fill",a));return this};C.prototype.stroke=function(a,b,c,d){"boolean"==typeof a?this.styleTo("stroked",a):(this.styleTo("stroked",!0),this.styleTo("stroke",a),b&&this.styleTo("stroke-width",b),c&&this.styleTo("stroke-linejoin",c),d&&this.styleTo("stroke-linecap",
d));return this};C.prototype.cls=function(a){this._ctx.currentClass="boolean"==typeof a?"":a;return this};C.prototype.font=function(a,b,c,d,e){"number"==typeof a?(this._font.size=a,e&&(this._font.face=e),b&&(this._font.weight=b),c&&(this._font.style=c),d&&(this._font.lineHeight=d)):this._font=a;this._ctx.style.font=this._font.value;return this};C.prototype.reset=function(){this._ctx.style=Object.assign({},this._style);this._font=new ca(10,"sans-serif");this._ctx.style.font=this._font.value;return this};
C.prototype.updateScope=function(a,b){this._ctx.group=b;this._ctx.groupID=a;this._ctx.groupCount=0;this.nextID();return this._ctx};C.prototype.scope=function(a){if(!a||null==a.animateID)throw Error("item not defined or not yet added to Space");return this.updateScope(C.scopeID(a),this.space.element)};C.prototype.nextID=function(){this._ctx.groupCount++;this._ctx.currentID=this._ctx.groupID+"-"+this._ctx.groupCount;return this._ctx.currentID};C.getID=function(a){return a.currentID||"p-"+C.domID++};
C.scopeID=function(a){return"item-"+a.animateID};C.style=function(a,b){var c=[];b.filled||c.push("fill: none");b.stroked||c.push("stroke: none");for(var d in b)if(b.hasOwnProperty(d)&&"filled"!=d&&"stroked"!=d){var e=b[d];e&&(b.filled||0!==d.indexOf("fill"))&&(b.stroked||0!==d.indexOf("stroke"))&&c.push(d+": "+e)}return I.setAttr(a,{style:c.join(";")})};C.point=function(a,b,c,d){c=void 0===c?5:c;return"circle"===(void 0===d?"square":d)?C.circle(a,b,c):C.square(a,b,c)};C.prototype.point=function(a,
b,c){b=void 0===b?5:b;c=void 0===c?"square":c;this.nextID();C.point(this._ctx,a,b,c);return this};C.circle=function(a,b,c){c=void 0===c?10:c;var d=U.svgElement(a.group,"circle",C.getID(a));I.setAttr(d,{cx:b[0],cy:b[1],r:c,"class":"pts-svgform pts-circle "+a.currentClass});C.style(d,a.style);return d};C.prototype.circle=function(a){this.nextID();a=g.iterToArray(a);C.circle(this._ctx,a[0],a[1][0]);return this};C.arc=function(a,b,c,d,e,f){var h=U.svgElement(a.group,"path",C.getID(a)),u=(new k(b)).toAngle(d,
c,!0);b=(new k(b)).toAngle(e,c,!0);d=z.boundAngle(e)-z.boundAngle(d)>l?!0:!1;f&&(d=!d);I.setAttr(h,{d:"M "+u[0]+" "+u[1]+" A "+c+" "+c+" 0 "+(d?"1":"0")+" "+(f?"0":"1")+" "+b[0]+" "+b[1],"class":"pts-svgform pts-arc "+a.currentClass});C.style(h,a.style);return h};C.prototype.arc=function(a,b,c,d,e){this.nextID();C.arc(this._ctx,a,b,c,d,e);return this};C.square=function(a,b,c){var d=U.svgElement(a.group,"rect",C.getID(a));I.setAttr(d,{x:b[0]-c,y:b[1]-c,width:2*c,height:2*c,"class":"pts-svgform pts-square "+
a.currentClass});C.style(d,a.style);return d};C.prototype.square=function(a,b){this.nextID();C.square(this._ctx,a,b);return this};C.line=function(a,b){var c=C.pointsString(b);if(!(2>c.count)){if(2<c.count)return C._poly(a,c.string,!1);c=U.svgElement(a.group,"line",C.getID(a));b=g.iterToArray(b);I.setAttr(c,{x1:b[0][0],y1:b[0][1],x2:b[1][0],y2:b[1][1],"class":"pts-svgform pts-line "+a.currentClass});C.style(c,a.style);return c}};C.prototype.line=function(a){this.nextID();C.line(this._ctx,a);return this};
C._poly=function(a,b,c){c=U.svgElement(a.group,void 0===c||c?"polygon":"polyline",C.getID(a));I.setAttr(c,{points:b,"class":"pts-svgform pts-polygon "+a.currentClass});C.style(c,a.style);return c};C.pointsString=function(a){var b="",c=0;a=$jscomp.makeIterator(a);for(var d=a.next();!d.done;d=a.next())d=d.value,b+=d[0]+","+d[1]+" ",c++;return{string:b,count:c}};C.polygon=function(a,b){b=C.pointsString(b);return C._poly(a,b.string,!0)};C.prototype.polygon=function(a){this.nextID();C.polygon(this._ctx,
a);return this};C.rect=function(a,b){if(g.arrayCheck(b)){var c=U.svgElement(a.group,"rect",C.getID(a));b=n.fromArray(b).boundingBox();var d=p.size(b);I.setAttr(c,{x:b[0][0],y:b[0][1],width:d[0],height:d[1],"class":"pts-svgform pts-rect "+a.currentClass});C.style(c,a.style);return c}};C.prototype.rect=function(a){this.nextID();C.rect(this._ctx,a);return this};C.text=function(a,b,c){var d=U.svgElement(a.group,"text",C.getID(a));I.setAttr(d,{"pointer-events":"none",x:b[0],y:b[1],dx:0,dy:0,"class":"pts-svgform pts-text "+
a.currentClass});d.textContent=c;C.style(d,a.style);return d};C.prototype.text=function(a,b){this.nextID();C.text(this._ctx,a,b);return this};C.prototype.log=function(a){this.fill("#000").stroke("#fff",.5).text([10,14],a);return this};$jscomp.global.Object.defineProperties(C.prototype,{space:{configurable:!0,enumerable:!0,get:function(){return this._space}}});C.groupID=0;C.domID=0;var R=function(a,b,c){b=void 0===b?1:b;c=void 0===c?0:c;this._lastTime=null;this._gravity=new Pt;this._friction=1;this._damping=
.75;this._particles=[];this._bodies=[];this._pnames=[];this._bnames=[];this._bound=Bound.fromGroup(a);this._friction=b;this._gravity="number"===typeof c?new Pt(0,c):new Pt(c);return this};R.prototype.body=function(a){var b=a;"string"===typeof a&&0<a.length&&(b=this._bnames.indexOf(a));if(0<=b)return this._bodies[b]};R.prototype.particle=function(a){var b=a;"string"===typeof a&&0<a.length&&(b=this._pnames.indexOf(a));if(0<=b)return this._particles[b]};R.prototype.bodyIndex=function(a){return this._bnames.indexOf(a)};
R.prototype.particleIndex=function(a){return this._pnames.indexOf(a)};R.prototype.update=function(a){a/=1E3;this._updateParticles(a);this._updateBodies(a)};R.prototype.drawParticles=function(a){this._drawParticles=a};R.prototype.drawBodies=function(a){this._drawBodies=a};R.prototype.add=function(a,b){b=void 0===b?"":b;a instanceof Y?(this._bodies.push(a),this._bnames.push(b)):(this._particles.push(a),this._pnames.push(b));return this};R.prototype._index=function(a,b){if("string"===typeof b){if(a=
a(b),0>a)throw Error("Cannot find index of "+b+". You can use particleIndex() or bodyIndex() function to check existence by name.");}else a=b;return a};R.prototype.removeBody=function(a,b){b=void 0===b?1:b;a=this._index(this.bodyIndex.bind(this),a);b=0>a?[-1*a-1,b]:[a,b];this._bodies.splice(b[0],b[1]);this._bnames.splice(b[0],b[1]);return this};R.prototype.removeParticle=function(a,b){b=void 0===b?1:b;a=this._index(this.particleIndex.bind(this),a);b=0>a?[-1*a-1,b]:[a,b];this._particles.splice(b[0],
b[1]);this._pnames.splice(b[0],b[1]);return this};R.edgeConstraint=function(a,b,c,d,e){d=void 0===d?1:d;e=void 0===e?!1:e;var f=1/(a.mass||1),h=1/(b.mass||1),u=f+h,y=b.$subtract(a),G=c*c;c=e?c/y.magnitude()-1:G/(y.dot(y)+G)-.5;d=y.$multiply(c*d);a.subtract(d.$multiply(f/u));b.add(d.$multiply(h/u));return a};R.boundConstraint=function(a,b,c){c=void 0===c?.75:c;var d=Geom.boundingBox(b);b=a.$min(d[1].subtract(a.radius)).$max(d[0].add(a.radius));if(b[0]===d[0][0]||b[0]===d[1][0])c=a.changed.$multiply(c),
a.previous=b.$subtract(new Pt(-c[0],c[1]));else if(b[1]===d[0][1]||b[1]===d[1][1])c=a.changed.$multiply(c),a.previous=b.$subtract(new Pt(c[0],-c[1]));a.to(b)};R.prototype.integrate=function(a,b,c){a.addForce(this._gravity);a.verlet(b,this._friction,c);return a};R.prototype._updateParticles=function(a){for(var b=0,c=this._particles.length;b<c;b++){var d=this._particles[b];this.integrate(d,a,this._lastTime);R.boundConstraint(d,this._bound,this._damping);for(var e=b+1;e<c;e++)b!==e&&d.collide(this._particles[e],
this._damping);this._drawParticles&&this._drawParticles(d,b)}this._lastTime=a};R.prototype._updateBodies=function(a){for(var b=0,c=this._bodies.length;b<c;b++){var d=this._bodies[b];if(d){for(var e=0,f=d.length;e<f;e++){var h=d[e];R.boundConstraint(h,this._bound,this._damping);this.integrate(h,a,this._lastTime)}for(e=b+1;e<c;e++)d.processBody(this._bodies[e]);e=0;for(f=this._particles.length;e<f;e++)d.processParticle(this._particles[e]);d.processEdges();this._drawBodies&&this._drawBodies(d,b)}}};
$jscomp.global.Object.defineProperties(R.prototype,{bound:{configurable:!0,enumerable:!0,get:function(){return this._bound},set:function(a){this._bound=a}},gravity:{configurable:!0,enumerable:!0,get:function(){return this._gravity},set:function(a){this._gravity=a}},friction:{configurable:!0,enumerable:!0,get:function(){return this._friction},set:function(a){this._friction=a}},damping:{configurable:!0,enumerable:!0,get:function(){return this._damping},set:function(a){this._damping=a}},bodyCount:{configurable:!0,
enumerable:!0,get:function(){return this._bodies.length}},particleCount:{configurable:!0,enumerable:!0,get:function(){return this._particles.length}}});var ba=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];b=null.apply(this,[].concat($jscomp.arrayFromIterable(b)))||this;b._mass=1;b._radius=0;b._force=new Pt;b._prev=new Pt;b._lock=!1;b._prev=b.clone();return b};$jscomp.inherits(ba,null);ba.prototype.size=function(a){this._radius=this._mass=a;return this};ba.prototype.addForce=
function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];this._force.add.apply(this._force,$jscomp.arrayFromIterable(b));return this._force};ba.prototype.verlet=function(a,b,c){if(this._lock)this.to(this._lockPt);else{c=c?c:a;var d=this._force.multiply(a*(a+c)/2);a=this.changed.multiply(b*a/c).add(d);this._prev=this.clone();this.add(a);this._force=new Pt}return this};ba.prototype.hit=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];this._prev.subtract((new (Function.prototype.bind.apply(Pt,
[null].concat($jscomp.arrayFromIterable(b))))).$divide(Math.sqrt(this._mass)));return this};ba.prototype.collide=function(a,b){b=void 0===b?1:b;var c=this.$subtract(a),d=c.magnitudeSq(),e=this.radius+a.radius;if(d<e*e){var f=this.changed,h=a.changed,u=Math.sqrt(d);u=c.$multiply((u-e)/u/2);e=this.$subtract(u);u=a.$add(u);this.to(e);a.to(u);e=b*c.dot(f)/d;b=b*c.dot(h)/d;d=this.mass/(this.mass+a.mass);u=a.mass/(this.mass+a.mass);f.add((new Pt(b*c[0]-e*c[0],b*c[1]-e*c[1])).$multiply(u));h.add((new Pt(e*
c[0]-b*c[0],e*c[1]-b*c[1])).$multiply(d));this.previous=this.$subtract(f);a.previous=a.$subtract(h)}};ba.prototype.toString=function(){return"Particle: "+this[0]+" "+this[1]+" | previous "+this._prev[0]+" "+this._prev[1]+" | mass "+this._mass};$jscomp.global.Object.defineProperties(ba.prototype,{mass:{configurable:!0,enumerable:!0,get:function(){return this._mass},set:function(a){this._mass=a}},radius:{configurable:!0,enumerable:!0,get:function(){return this._radius},set:function(a){this._radius=
a}},previous:{configurable:!0,enumerable:!0,get:function(){return this._prev},set:function(a){this._prev=a}},force:{configurable:!0,enumerable:!0,get:function(){return this._force},set:function(a){this._force=a}},body:{configurable:!0,enumerable:!0,get:function(){return this._body},set:function(a){this._body=a}},lock:{configurable:!0,enumerable:!0,get:function(){return this._lock},set:function(a){this._lock=a;this._lockPt=new Pt(this)}},changed:{configurable:!0,enumerable:!0,get:function(){return this.$subtract(this._prev)}},
position:{configurable:!0,enumerable:!0,set:function(a){this.previous.to(this);this._lock&&(this._lockPt=a);this.to(a)}}});var Y=function(){var a=null.call(this)||this;a._cs=[];a._stiff=1;a._locks={};a._mass=1;return a};$jscomp.inherits(Y,null);Y.fromGroup=function(a,b,c,d){b=void 0===b?1:b;c=void 0===c?!0:c;d=void 0===d?!0:d;a=(new Y).init(a);c&&a.linkAll(b);d&&a.autoMass();return a};Y.prototype.init=function(a,b){b=void 0===b?1:b;var c=new Pt;a=$jscomp.makeIterator(a);for(var d=a.next();!d.done;d=
a.next()){d=d.value;var e=new ba(d);e.body=this;c.add(d);this.push(e)}this._stiff=b;return this};Y.prototype.autoMass=function(){this.mass=Math.sqrt(Polygon.area(this))/10;return this};Y.prototype.link=function(a,b,c){if(0>a||a>=this.length)throw Error("index1 is not in the Group's indices");if(0>b||b>=this.length)throw Error("index1 is not in the Group's indices");var d=this[a].$subtract(this[b]).magnitude();this._cs.push([a,b,d,c||this._stiff]);return this};Y.prototype.linkAll=function(a){for(var b=
this.length/2,c=0,d=this.length;c<d;c++){this.link(c,c>=d-1?0:c+1,a);if(4<d){var e=Math.floor(b/2)+1;this.link(c,c>=d-e?c%d:c+e,a)}c<=b-1&&this.link(c,Math.min(this.length-1,c+Math.floor(b)))}};Y.prototype.linksToLines=function(){for(var a=[],b=0,c=this._cs.length;b<c;b++){var d=this._cs[b];a.push(new Group(this[d[0]],this[d[1]]))}return a};Y.prototype.processEdges=function(){for(var a=0,b=this._cs.length;a<b;a++){var c=$jscomp.makeIterator(this._cs[a]),d=c.next().value,e=c.next().value,f=c.next().value;
c=c.next().value;R.edgeConstraint(this[d],this[e],f,c)}};Y.prototype.processBody=function(a){if(a=Polygon.hasIntersectPolygon(this,a)){var b=a.normal.$multiply(a.dist),c=a.edge;var d=Math.abs(c[0][0]-c[1][0])>Math.abs(c[0][1]-c[1][1])?(a.vertex[0]-b[0]-c[0][0])/(c[1][0]-c[0][0]):(a.vertex[1]-b[1]-c[0][1])/(c[1][1]-c[0][1]);var e=1/(d*d+(1-d)*(1-d)),f=a.vertex.body.mass||1,h=a.edge[0].body.mass||1,u=f/(f+h);f=h/(f+h);c[0].subtract(b.$multiply(u*(1-d)*e/2));c[1].subtract(b.$multiply(u*d*e/2));a.vertex.add(b.$multiply(f))}};
Y.prototype.processParticle=function(a){var b=Polygon.hasIntersectCircle(this,Circle.fromCenter(a,a.radius));if(b){var c=b.normal.$multiply(b.dist),d=b.edge;var e=Math.abs(d[0][0]-d[1][0])>Math.abs(d[0][1]-d[1][1])?(b.vertex[0]-c[0]-d[0][0])/(d[1][0]-d[0][0]):(b.vertex[1]-c[1]-d[0][1])/(d[1][1]-d[0][1]);var f=1/(e*e+(1-e)*(1-e)),h=b.vertex.mass||a.mass||1,u=b.edge[0].body.mass||1;b=h/(h+u);h=u/(h+u);d[0].subtract(c.$multiply(b*(1-e)*f/2));d[1].subtract(c.$multiply(b*e*f/2));c=a.changed.add(c.$multiply(h));
a.previous=a.$subtract(c)}};$jscomp.global.Object.defineProperties(Y.prototype,{mass:{configurable:!0,enumerable:!0,get:function(){return this._mass},set:function(a){this._mass=a;a=0;for(var b=this.length;a<b;a++)this[a].mass=this._mass}}});var la=function(a,b,c,d){function e(f){return f instanceof c?f:new c(function(h){h(f)})}return new (c||(c=Promise))(function(f,h){function u(J){try{G(d.next(J))}catch(P){h(P)}}function y(J){try{G(d["throw"](J))}catch(P){h(P)}}function G(J){J.done?f(J.value):e(J.value).then(u,
y)}G((d=d.apply(a,b||[])).next())})},M=function(a){this._playing=!1;this._type=a;a=window.AudioContext||window.webkitAudioContext||!1;if(!a)throw Error("Your browser doesn't support Web Audio. (No AudioContext)");this._ctx=a?new a:void 0};M.from=function(a,b,c,d){c=new M(void 0===c?"gen":c);c._node=a;c._ctx=b;d&&(c._stream=d);return c};M.load=function(a,b){b=void 0===b?"anonymous":b;return new Promise(function(c,d){var e=new M("file");e._source="string"===typeof a?new Audio(a):a;e._source.autoplay=
!1;e._source.crossOrigin=b;e._source.addEventListener("ended",function(){e._playing=!1});e._source.addEventListener("error",function(){d("Error loading sound")});e._source.addEventListener("canplaythrough",function(){e._node=e._ctx.createMediaElementSource(e._source);c(e)})})};M.loadAsBuffer=function(a){return new Promise(function(b,c){var d=new XMLHttpRequest;d.open("GET",a,!0);d.responseType="arraybuffer";var e=new M("file");d.onload=function(){e._ctx.decodeAudioData(d.response,function(f){e.createBuffer(f);
b(e)},function(f){return c("Error decoding audio")})};d.send()})};M.prototype.createBuffer=function(a){var b=this;this._node=this._ctx.createBufferSource();void 0!==a&&(this._buffer=a);this._node.buffer=this._buffer;this._node.onended=function(){b._playing=!1};return this};M.generate=function(a,b){return(new M("gen"))._gen(a,b)};M.prototype._gen=function(a,b){var c=this._node=this._ctx.createOscillator();c.type=a;"custom"===a?c.setPeriodicWave(b):c.frequency.value=b;return this};M.input=function(a){return la(this,
void 0,void 0,function c(){var d,e,f;return $jscomp.generator.createGenerator(c,function(h){if(1==h.nextAddress){h.setCatchFinallyBlocks(2);d=new M("input");if(!d)return h.return(void 0);e=a?a:{audio:!0,video:!1};f=d;return h.yield(navigator.mediaDevices.getUserMedia(e),4)}if(2!=h.nextAddress)return f._stream=h.yieldResult,d._node=d._ctx.createMediaStreamSource(d._stream),h.return(d);h.enterCatchBlock();console.error("Cannot get audio from input device.");return h.return(Promise.resolve(null))})})};
M.prototype.connect=function(a){this._node.connect(a);return this};M.prototype.setOutputNode=function(a){this._outputNode=a;return this};M.prototype.removeOutputNode=function(){this._outputNode=null;return this};M.prototype.analyze=function(a,b,c,d){a=void 0===a?256:a;b=void 0===b?-100:b;c=void 0===c?-30:c;d=void 0===d?.8:d;var e=this._ctx.createAnalyser();e.fftSize=2*a;e.minDecibels=b;e.maxDecibels=c;e.smoothingTimeConstant=d;this.analyzer={node:e,size:e.frequencyBinCount,data:new Uint8Array(e.frequencyBinCount)};
this._node.connect(this.analyzer.node);return this};M.prototype._domain=function(a){return this.analyzer?(a?this.analyzer.node.getByteTimeDomainData(this.analyzer.data):this.analyzer.node.getByteFrequencyData(this.analyzer.data),this.analyzer.data):new Uint8Array(0)};M.prototype._domainTo=function(a,b,c,d){c=void 0===c?[0,0]:c;d=void 0===d?[0,0]:d;a=a?this.timeDomain():this.freqDomain();var e=new n,f=d[0];for(d=a.length-d[1];f<d;f++)e.push(new k(c[0]+b[0]*f/d,c[1]+b[1]*a[f]/255));return e};M.prototype.timeDomain=
function(){return this._domain(!0)};M.prototype.timeDomainTo=function(a,b,c){b=void 0===b?[0,0]:b;c=void 0===c?[0,0]:c;return this._domainTo(!0,a,b,c)};M.prototype.freqDomain=function(){return this._domain(!1)};M.prototype.freqDomainTo=function(a,b,c){b=void 0===b?[0,0]:b;c=void 0===c?[0,0]:c;return this._domainTo(!1,a,b,c)};M.prototype.reset=function(){this.stop();this._node.disconnect();return this};M.prototype.start=function(a){a=void 0===a?0:a;"suspended"===this._ctx.state&&this._ctx.resume();
"file"===this._type?this._buffer?(this._node.start(a),this._timestamp=this._ctx.currentTime+a):(this._source.play(),0<a&&(this._source.currentTime=a)):"gen"===this._type&&(this._gen(this._node.type,this._node.frequency.value),this._node.start(),this.analyzer&&this._node.connect(this.analyzer.node));(this._outputNode||this._node).connect(this._ctx.destination);this._playing=!0;return this};M.prototype.stop=function(){this._playing&&(this._outputNode||this._node).disconnect(this._ctx.destination);"file"===
this._type?this._buffer?1>this.progress&&this._node.stop():this._source.pause():"gen"===this._type?this._node.stop():"input"===this._type&&this._stream.getAudioTracks().forEach(function(a){return a.stop()});this._playing=!1;return this};M.prototype.toggle=function(){this._playing?this.stop():this.start();return this};$jscomp.global.Object.defineProperties(M.prototype,{ctx:{configurable:!0,enumerable:!0,get:function(){return this._ctx}},node:{configurable:!0,enumerable:!0,get:function(){return this._node}},
outputNode:{configurable:!0,enumerable:!0,get:function(){return this._outputNode}},stream:{configurable:!0,enumerable:!0,get:function(){return this._stream}},source:{configurable:!0,enumerable:!0,get:function(){return this._source}},buffer:{configurable:!0,enumerable:!0,get:function(){return this._buffer},set:function(a){this._buffer=a}},type:{configurable:!0,enumerable:!0,get:function(){return this._type}},playing:{configurable:!0,enumerable:!0,get:function(){return this._playing}},progress:{configurable:!0,
enumerable:!0,get:function(){if(this._buffer){var a=this._buffer.duration;var b=this._timestamp?this._ctx.currentTime-this._timestamp:0}else a=this._source.duration,b=this._source.currentTime;return b/a}},playable:{configurable:!0,enumerable:!0,get:function(){return"input"===this._type?void 0!==this._node:!!this._buffer||4===this._source.readyState}},binSize:{configurable:!0,enumerable:!0,get:function(){return this.analyzer.size}},sampleRate:{configurable:!0,enumerable:!0,get:function(){return this._ctx.sampleRate}},
frequency:{configurable:!0,enumerable:!0,get:function(){return"gen"===this._type?this._node.frequency.value:0},set:function(a){"gen"===this._type&&(this._node.frequency.value=a)}}});var ia=(new M).ctx,fa=(new L("dave")).setup({bgcolor:"#fff",resize:!0,retina:!0}),ma=fa.getForm();fa.add({start:function(a,b){console.log(ia)},animate:function(a,b,c){a=20*D.cycle(a%1E3/1E3);ma.fill("#09f").point(fa.pointer,a,"circle")},action:function(a,b,c,d){"up"===a&&"suspended"===ia.state&&ia.resume()},resize:function(a,
b){console.log(a)}});fa.bindMouse().bindTouch().play()})();}).call(this || window)
